
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Multi-Destination Trip Planner 2026 - goFLY Limited</title>
<meta name="description" content="Plan your perfect multi-destination trip. Thailand, Malaysia, Singapore & 11+ destinations. Instant land package quotes, 90-98% visa success, EMI available.">
<link rel="canonical" href="https://goflybd.com/trip-planner/">

<!-- Leaflet Map CSS -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

<link href="https://fonts.googleapis.com/css2?family=Cantora+One&family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
:root {
    --primary: #10b981;
    --primary-dark: #059669;
    --secondary: #f97316;
    --secondary-dark: #ea580c;
    --danger: #ef4444;
    --warning: #f59e0b;
    --info: #3b82f6;
    --gray-50: #f8fafc;
    --gray-100: #f1f5f9;
    --gray-200: #e2e8f0;
    --gray-300: #cbd5e1;
    --gray-400: #94a3b8;
    --gray-500: #64748b;
    --gray-600: #475569;
    --gray-700: #334155;
    --gray-800: #1e293b;
}

body {
    font-family: 'Inter', sans-serif;
    background: linear-gradient(135deg, #f0fdf4 0%, #fff7ed 100%);
    min-height: 100vh;
    padding: 20px;
    color: var(--gray-800);
}

.container { max-width: 1400px; margin: 0 auto; }

.header {
    text-align: center;
    margin-bottom: 40px;
    animation: fadeInDown 0.6s ease;
}

.header h1 {
    font-family: 'Cantora One', sans-serif;
    font-size: 2.8rem;
    background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    margin-bottom: 12px;
}

/* Limited Time Offer Banner */
.offer-banner {
    background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
    color: white;
    padding: 16px 24px;
    border-radius: 12px;
    margin-bottom: 24px;
    text-align: center;
    animation: pulse 2s infinite;
    position: relative;
    overflow: hidden;
}

.offer-banner::before {
    content: 'üéâ';
    position: absolute;
    left: 20px;
    top: 50%;
    transform: translateY(-50%);
    font-size: 2rem;
}

.offer-banner::after {
    content: 'üéâ';
    position: absolute;
    right: 20px;
    top: 50%;
    transform: translateY(-50%);
    font-size: 2rem;
}

.offer-banner h3 { font-size: 1.3rem; margin-bottom: 4px; }
.offer-banner p { font-size: 0.95rem; opacity: 0.95; }
.offer-countdown { font-weight: 700; font-size: 1.1rem; margin-top: 8px; }

@keyframes pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.01); }
}

.trust-badges {
    display: flex;
    justify-content: center;
    gap: 24px;
    margin-top: 20px;
    flex-wrap: wrap;
}

.trust-badge {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 0.9rem;
    color: var(--gray-600);
}

.trust-badge strong { color: var(--primary); }

/* Currency Converter */
.currency-converter {
    background: white;
    border-radius: 16px;
    padding: 20px;
    margin-bottom: 24px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.08);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 20px;
    flex-wrap: wrap;
}

.currency-converter h4 {
    color: var(--gray-700);
    font-size: 0.95rem;
}

.currency-rates {
    display: flex;
    gap: 16px;
    flex-wrap: wrap;
}

.currency-rate {
    background: var(--gray-50);
    padding: 8px 16px;
    border-radius: 8px;
    font-size: 0.9rem;
    display: flex;
    align-items: center;
    gap: 8px;
}

.currency-rate .flag { font-size: 1.2rem; }
.currency-rate .rate { font-weight: 600; color: var(--primary); }

/* Map Container */
.map-container {
    background: white;
    border-radius: 20px;
    padding: 24px;
    margin-bottom: 24px;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.08);
    display: none;
}

.map-container.show { display: block; animation: fadeIn 0.5s ease; }

.map-container h3 {
    font-size: 1.3rem;
    margin-bottom: 16px;
    color: var(--gray-800);
    display: flex;
    align-items: center;
    gap: 8px;
}

#tripMap {
    height: 300px;
    border-radius: 12px;
    z-index: 1;
}

/* Smart Warning Box */
.smart-warning {
    background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);
    border: 2px solid var(--danger);
    border-radius: 16px;
    padding: 24px;
    margin: 20px 0;
    display: none;
    animation: shake 0.5s ease;
}

.smart-warning.show { display: block; }

.smart-warning h4 {
    color: var(--danger);
    font-size: 1.2rem;
    margin-bottom: 12px;
    display: flex;
    align-items: center;
    gap: 8px;
}

.smart-warning p {
    color: #991b1b;
    line-height: 1.6;
    margin-bottom: 16px;
}

.smart-warning .suggestion-buttons {
    display: flex;
    gap: 12px;
    flex-wrap: wrap;
}

.smart-warning .btn-suggest {
    padding: 10px 20px;
    border-radius: 8px;
    border: none;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
    font-family: 'Inter', sans-serif;
}

.smart-warning .btn-extend {
    background: var(--primary);
    color: white;
}

.smart-warning .btn-extend:hover {
    background: var(--primary-dark);
    transform: translateY(-2px);
}

.smart-warning .btn-keep {
    background: var(--gray-200);
    color: var(--gray-700);
}

/* Recommended Combos */
.recommended-combos {
    background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
    border-radius: 16px;
    padding: 20px;
    margin: 20px 0;
    border-left: 4px solid var(--info);
}

.recommended-combos h4 {
    color: #1e40af;
    margin-bottom: 12px;
    font-size: 1.1rem;
}

.combo-chips {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
}

.combo-chip {
    background: white;
    padding: 10px 16px;
    border-radius: 25px;
    font-size: 0.9rem;
    cursor: pointer;
    transition: all 0.3s;
    border: 2px solid transparent;
    display: flex;
    align-items: center;
    gap: 8px;
}

.combo-chip:hover {
    border-color: var(--info);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(59, 130, 246, 0.2);
}

.combo-chip.trending::after {
    content: 'üî•';
    margin-left: 4px;
}

/* Interest Selector */
.interest-selector {
    background: linear-gradient(135deg, #fdf4ff 0%, #fae8ff 100%);
    border-radius: 16px;
    padding: 20px;
    margin-bottom: 20px;
    border-left: 4px solid #a855f7;
}

.interest-selector h4 {
    color: #7e22ce;
    margin-bottom: 12px;
    font-size: 1.1rem;
}

.interest-chips {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
}

.interest-chip {
    background: white;
    padding: 10px 18px;
    border-radius: 25px;
    font-size: 0.9rem;
    cursor: pointer;
    transition: all 0.3s;
    border: 2px solid transparent;
}

.interest-chip:hover {
    border-color: #a855f7;
    background: #faf5ff;
}

.interest-chip.selected {
    background: linear-gradient(135deg, #a855f7 0%, #7c3aed 100%);
    color: white;
    border-color: #a855f7;
}

.interest-chip .icon { margin-right: 6px; }

/* Photo Carousel */
.destination-photos {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    display: flex;
    gap: 4px;
    padding: 8px;
    z-index: 2;
}

.photo-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: rgba(255,255,255,0.5);
    cursor: pointer;
    transition: all 0.3s;
}

.photo-dot.active { background: white; transform: scale(1.3); }

.planner-card {
    background: white;
    border-radius: 24px;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
    padding: 40px;
    animation: fadeInUp 0.6s ease;
}

.step-indicator {
    display: flex;
    justify-content: space-between;
    margin-bottom: 40px;
    position: relative;
}

.step-indicator::before {
    content: '';
    position: absolute;
    top: 20px;
    left: 0;
    right: 0;
    height: 2px;
    background: var(--gray-200);
    z-index: 0;
}

.step {
    display: flex;
    flex-direction: column;
    align-items: center;
    position: relative;
    z-index: 1;
    flex: 1;
}

.step-number {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: var(--gray-200);
    color: var(--gray-400);
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 600;
    margin-bottom: 8px;
    transition: all 0.3s;
}

.step.active .step-number {
    background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
    color: white;
    transform: scale(1.1);
}

.step.completed .step-number { background: var(--primary); color: white; }
.step-label { font-size: 0.85rem; color: var(--gray-500); text-align: center; }
.step.active .step-label { color: var(--primary); font-weight: 600; }

.form-section { display: none; animation: fadeIn 0.4s ease; }
.form-section.active { display: block; }

.form-group { margin-bottom: 24px; }

.form-group label {
    display: block;
    font-weight: 600;
    color: var(--gray-800);
    margin-bottom: 8px;
    font-size: 0.95rem;
}

.destination-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 16px;
    margin-top: 16px;
}

.destination-card {
    position: relative;
    border-radius: 16px;
    overflow: hidden;
    cursor: pointer;
    transition: all 0.3s;
    border: 3px solid transparent;
    height: 220px;
    background-size: cover;
    background-position: center;
}

.destination-card::before {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(to bottom, rgba(0,0,0,0.1) 0%, rgba(0,0,0,0.7) 100%);
    transition: all 0.3s;
}

.destination-card:hover::before {
    background: linear-gradient(to bottom, rgba(16,185,129,0.3) 0%, rgba(16,185,129,0.8) 100%);
}

.destination-card.selected {
    border-color: var(--primary);
    transform: translateY(-4px);
    box-shadow: 0 12px 30px rgba(16, 185, 129, 0.3);
}

.destination-card.selected::before {
    background: linear-gradient(to bottom, rgba(16,185,129,0.4) 0%, rgba(16,185,129,0.85) 100%);
}

.destination-card.recommended {
    border-color: var(--warning);
}

.destination-card.recommended::after {
    content: '‚ú® Recommended';
    position: absolute;
    top: 10px;
    right: 10px;
    background: var(--warning);
    color: white;
    padding: 4px 10px;
    border-radius: 20px;
    font-size: 0.75rem;
    font-weight: 600;
    z-index: 3;
}

.destination-content {
    position: relative;
    z-index: 1;
    padding: 20px;
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    color: white;
}

.destination-name { font-size: 1.5rem; font-weight: 700; margin-bottom: 6px; }
.destination-category { font-size: 0.85rem; opacity: 0.9; }

.destination-tags {
    display: flex;
    gap: 6px;
    flex-wrap: wrap;
    margin-top: 8px;
}

.destination-tag {
    background: rgba(255,255,255,0.2);
    padding: 3px 8px;
    border-radius: 12px;
    font-size: 0.75rem;
}

.selected-destinations {
    background: linear-gradient(135deg, #f0fdf4 0%, #ecfdf5 100%);
    padding: 20px;
    border-radius: 12px;
    margin-top: 20px;
    border: 2px solid var(--primary);
}

.selected-destinations h4 { color: var(--primary); margin-bottom: 12px; font-size: 1.1rem; }

.selected-list { display: flex; flex-wrap: wrap; gap: 8px; }

.selected-item {
    background: white;
    padding: 8px 16px;
    border-radius: 20px;
    font-size: 0.9rem;
    display: flex;
    align-items: center;
    gap: 8px;
    border: 1px solid var(--gray-200);
}

.remove-btn { cursor: pointer; color: var(--secondary); font-weight: bold; }

/* Optional Add-ons */
.addons-section {
    background: linear-gradient(135deg, #f0fdf4 0%, #ecfdf5 100%);
    border-radius: 16px;
    padding: 24px;
    margin: 24px 0;
    border: 2px solid var(--primary);
}

.addons-section h4 {
    color: var(--primary);
    margin-bottom: 16px;
    font-size: 1.1rem;
    display: flex;
    align-items: center;
    gap: 8px;
}

.addons-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 12px;
}

.addon-item {
    background: white;
    padding: 16px;
    border-radius: 12px;
    display: flex;
    align-items: center;
    gap: 12px;
    cursor: pointer;
    transition: all 0.3s;
    border: 2px solid transparent;
}

.addon-item:hover { border-color: var(--primary); }
.addon-item.selected { border-color: var(--primary); background: #f0fdf4; }

.addon-item input[type="checkbox"] {
    width: 20px;
    height: 20px;
    cursor: pointer;
}

.addon-info { flex: 1; }
.addon-name { font-weight: 600; color: var(--gray-800); font-size: 0.95rem; }
.addon-desc { font-size: 0.8rem; color: var(--gray-500); margin-top: 2px; }
.addon-price { font-weight: 700; color: var(--secondary); font-size: 1rem; }

.addons-total {
    margin-top: 16px;
    padding-top: 16px;
    border-top: 2px dashed var(--gray-300);
    display: flex;
    justify-content: space-between;
    font-weight: 600;
}

.addons-total .total-label { color: var(--gray-700); }
.addons-total .total-amount { color: var(--primary); font-size: 1.2rem; }

/* Peak Season 2026 */
.peak-season-2026 {
    background: linear-gradient(135deg, #fef3c7 0%, #fed7aa 100%);
    padding: 16px;
    border-radius: 12px;
    margin-top: 12px;
    border-left: 4px solid var(--warning);
}

.peak-season-2026 h5 {
    color: #92400e;
    margin-bottom: 8px;
    font-size: 0.95rem;
}

.peak-dates {
    display: flex;
    gap: 12px;
    flex-wrap: wrap;
}

.peak-date {
    background: white;
    padding: 8px 12px;
    border-radius: 8px;
    font-size: 0.85rem;
    color: #92400e;
}

.peak-date .date { font-weight: 600; }

select, input[type="number"], input[type="date"], input[type="text"], input[type="tel"], input[type="email"] {
    width: 100%;
    padding: 14px 16px;
    border: 2px solid var(--gray-200);
    border-radius: 12px;
    font-size: 1rem;
    font-family: 'Inter', sans-serif;
    transition: all 0.3s;
    background: white;
}

select:focus, input:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
}

input.error, select.error {
    border-color: #ef4444 !important;
    animation: shake 0.5s;
}

@keyframes shake {
    0%, 100% { transform: translateX(0); }
    25% { transform: translateX(-10px); }
    75% { transform: translateX(10px); }
}

.error-message {
    color: #ef4444;
    font-size: 0.85rem;
    margin-top: 6px;
    font-weight: 600;
    display: none;
}

.error-message.show { display: block; }

.budget-options {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 16px;
    margin-top: 16px;
}

.budget-option {
    padding: 24px;
    border: 2px solid var(--gray-200);
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.3s;
    text-align: center;
}

.budget-option:hover {
    border-color: var(--primary);
    background: #f0fdf4;
    transform: translateY(-2px);
}

.budget-option.selected {
    border-color: var(--primary);
    background: linear-gradient(135deg, #f0fdf4 0%, #ecfdf5 100%);
    box-shadow: 0 4px 12px rgba(16, 185, 129, 0.2);
}

.budget-option .icon { font-size: 2rem; margin-bottom: 12px; }
.budget-option h3 { font-size: 1.2rem; color: var(--gray-800); margin-bottom: 8px; }
.budget-option p { font-size: 0.9rem; color: var(--gray-500); }

.checkbox-group {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 12px;
    margin-top: 12px;
}

.checkbox-label {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 12px;
    border: 2px solid var(--gray-200);
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s;
}

.checkbox-label:hover { border-color: var(--primary); background: #f0fdf4; }
.checkbox-label input:checked ~ span { font-weight: 600; color: var(--primary); }
.checkbox-label input { width: 18px; height: 18px; cursor: pointer; }

.button-group {
    display: flex;
    gap: 16px;
    margin-top: 32px;
    justify-content: space-between;
}

.btn {
    padding: 14px 32px;
    border: none;
    border-radius: 12px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
    font-family: 'Inter', sans-serif;
}

.btn-secondary { background: var(--gray-100); color: var(--gray-600); }
.btn-secondary:hover { background: var(--gray-200); }

.btn-primary {
    background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
    color: white;
    flex: 1;
}

.btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(16, 185, 129, 0.3);
}

.btn-primary:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }

/* Why This Itinerary Section */
.why-itinerary {
    background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
    border-radius: 16px;
    padding: 24px;
    margin: 24px 0;
    border-left: 4px solid var(--primary);
}

.why-itinerary h4 {
    color: var(--primary-dark);
    margin-bottom: 16px;
    font-size: 1.2rem;
    display: flex;
    align-items: center;
    gap: 8px;
}

.why-points {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 12px;
}

.why-point {
    background: white;
    padding: 12px 16px;
    border-radius: 10px;
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 0.9rem;
}

.why-point .icon { font-size: 1.3rem; }
.why-point .text { color: var(--gray-700); }

/* Rating Section */
.rating-section {
    background: linear-gradient(135deg, #fdf4ff 0%, #fae8ff 100%);
    border-radius: 16px;
    padding: 24px;
    margin: 24px 0;
    text-align: center;
    border-left: 4px solid #a855f7;
}

.rating-section h4 {
    color: #7e22ce;
    margin-bottom: 16px;
    font-size: 1.1rem;
}

.rating-stars {
    display: flex;
    justify-content: center;
    gap: 12px;
    margin-bottom: 16px;
}

.rating-star {
    font-size: 2.5rem;
    cursor: pointer;
    transition: all 0.2s;
    filter: grayscale(100%);
}

.rating-star:hover,
.rating-star.active {
    filter: grayscale(0%);
    transform: scale(1.2);
}

.rating-feedback {
    display: none;
    margin-top: 16px;
}

.rating-feedback.show { display: block; }

.rating-feedback textarea {
    width: 100%;
    padding: 12px;
    border: 2px solid var(--gray-200);
    border-radius: 10px;
    font-family: 'Inter', sans-serif;
    resize: vertical;
    min-height: 80px;
}

.rating-submit {
    margin-top: 12px;
    background: linear-gradient(135deg, #a855f7 0%, #7c3aed 100%);
    color: white;
    padding: 12px 24px;
    border: none;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
}

.itinerary-result { display: none; }
.itinerary-result.active { display: block; animation: fadeIn 0.6s ease; }

.result-header {
    background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
    color: white;
    padding: 40px;
    border-radius: 16px;
    margin-bottom: 24px;
    text-align: center;
}

.result-header h2 { font-family: 'Cantora One', sans-serif; font-size: 2.2rem; margin-bottom: 12px; }

.discount-badge {
    display: inline-block;
    background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
    color: #78350f;
    padding: 8px 16px;
    border-radius: 25px;
    font-weight: 700;
    font-size: 0.9rem;
    margin-top: 12px;
    animation: pulse 1.5s infinite;
}

.trip-summary {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 16px;
    margin-bottom: 32px;
}

.summary-item {
    background: var(--gray-50);
    padding: 20px;
    border-radius: 12px;
    text-align: center;
}

.summary-item .label { font-size: 0.85rem; color: var(--gray-500); margin-bottom: 8px; }
.summary-item .value { font-size: 1.4rem; font-weight: 700; color: var(--gray-800); }

.day-itinerary {
    background: var(--gray-50);
    padding: 24px;
    border-radius: 12px;
    margin-bottom: 16px;
    border-left: 4px solid var(--primary);
}

.day-itinerary.travel-day {
    border-left-color: var(--secondary);
    background: linear-gradient(135deg, #fff7ed 0%, #ffedd5 100%);
}

.day-itinerary h3 {
    font-size: 1.3rem;
    color: var(--gray-800);
    margin-bottom: 16px;
    display: flex;
    align-items: center;
    gap: 12px;
    flex-wrap: wrap;
}

.day-badge {
    background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
    color: white;
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 0.9rem;
}

.day-badge.travel {
    background: linear-gradient(135deg, var(--secondary) 0%, var(--secondary-dark) 100%);
}

.activity-list { list-style: none; }

.activity-list li {
    padding: 12px 0;
    border-bottom: 1px solid var(--gray-200);
    display: flex;
    align-items: start;
    gap: 12px;
}

.activity-list li:last-child { border-bottom: none; }
.activity-time { font-weight: 600; color: var(--primary); min-width: 90px; font-size: 0.9rem; }
.activity-name { font-weight: 600; color: var(--gray-800); margin-bottom: 4px; }
.activity-desc { font-size: 0.9rem; color: var(--gray-500); }
.activity-price { font-size: 0.85rem; color: var(--secondary); font-weight: 600; margin-top: 4px; }

.price-breakdown {
    background: white;
    padding: 24px;
    border-radius: 12px;
    border: 2px solid var(--gray-200);
    margin-bottom: 24px;
}

.price-row {
    display: flex;
    justify-content: space-between;
    padding: 12px 0;
    border-bottom: 1px solid var(--gray-100);
}

.price-row.total {
    border-bottom: none;
    border-top: 2px solid var(--gray-200);
    margin-top: 8px;
    padding-top: 16px;
    font-weight: 700;
    font-size: 1.2rem;
    color: var(--primary);
}

.price-row.discount {
    color: var(--danger);
    font-weight: 600;
}

.price-category {
    background: var(--gray-50);
    padding: 12px 16px;
    margin: 16px 0 8px;
    border-radius: 8px;
    font-weight: 600;
    color: var(--gray-700);
}

.cta-section {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 16px;
    margin-top: 32px;
}

.cta-button {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
    padding: 18px 24px;
    border-radius: 12px;
    font-weight: 600;
    font-size: 1.05rem;
    text-decoration: none;
    transition: all 0.3s;
}

.cta-whatsapp {
    background: linear-gradient(135deg, #25d366 0%, #128c7e 100%);
    color: white;
}

.cta-whatsapp:hover {
    transform: translateY(-3px);
    box-shadow: 0 10px 25px rgba(37, 211, 102, 0.3);
}

.cta-call {
    background: linear-gradient(135deg, var(--secondary) 0%, var(--secondary-dark) 100%);
    color: white;
}

.cta-call:hover {
    transform: translateY(-3px);
    box-shadow: 0 10px 25px rgba(249, 115, 22, 0.3);
}

.cta-email {
    background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%);
    color: white;
}

.cta-email:hover {
    transform: translateY(-3px);
    box-shadow: 0 10px 25px rgba(99, 102, 241, 0.3);
}

.flight-notice {
    background: linear-gradient(135deg, #fef3c7 0%, #fed7aa 100%);
    padding: 24px;
    border-radius: 16px;
    margin-bottom: 24px;
    border-left: 4px solid var(--secondary);
    text-align: center;
}

.flight-notice h3 { color: #92400e; margin-bottom: 12px; font-size: 1.3rem; }
.flight-notice p { color: #92400e; font-size: 1rem; margin-bottom: 16px; line-height: 1.6; }

.flight-cta {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 12px;
    max-width: 600px;
    margin: 0 auto;
}

.flight-cta a {
    padding: 14px 24px;
    border-radius: 12px;
    text-decoration: none;
    font-weight: 600;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
}

.visa-links-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: 12px;
    margin-top: 12px;
}

.visa-link-card {
    background: white;
    padding: 16px;
    border-radius: 12px;
    text-decoration: none;
    color: var(--gray-800);
    display: flex;
    align-items: center;
    gap: 12px;
    transition: all 0.3s;
    border: 2px solid transparent;
}

.visa-link-card:hover {
    border-color: var(--secondary);
    transform: translateX(4px);
    box-shadow: 0 4px 12px rgba(249, 115, 22, 0.2);
}

.visa-link-card .flag { font-size: 2rem; }
.visa-link-card .info { flex: 1; }
.visa-link-card .country-name { font-weight: 600; font-size: 1rem; }
.visa-link-card .visa-type { font-size: 0.85rem; color: var(--gray-600); margin-top: 2px; }
.visa-link-card .arrow { color: var(--secondary); font-size: 1.2rem; }

.emi-calculator {
    background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
    border-radius: 16px;
    padding: 24px;
    margin-top: 24px;
    border-left: 4px solid #3b82f6;
}

.emi-calculator h3 { color: #1e40af; margin-bottom: 16px; font-size: 1.2rem; }

.emi-inputs {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 16px;
    margin-bottom: 16px;
}

.emi-input-group { display: flex; flex-direction: column; gap: 8px; }
.emi-input-group label { font-size: 0.9rem; color: #1e40af; font-weight: 600; }

.emi-result {
    background: white;
    padding: 20px;
    border-radius: 12px;
    margin-top: 16px;
    display: none;
}

.emi-result.show { display: block; }

.emi-result-row {
    display: flex;
    justify-content: space-between;
    padding: 12px 0;
    border-bottom: 1px solid var(--gray-100);
}

.emi-result-row:last-child {
    border-bottom: none;
    font-weight: 700;
    color: var(--primary);
    font-size: 1.1rem;
}

.download-buttons {
    display: flex;
    gap: 12px;
    margin-top: 24px;
    flex-wrap: wrap;
}

.btn-download {
    background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%);
    color: white;
    padding: 14px 28px;
    border-radius: 12px;
    text-decoration: none;
    font-weight: 600;
    display: inline-flex;
    align-items: center;
    gap: 8px;
    transition: all 0.3s;
    border: none;
    cursor: pointer;
    font-family: 'Inter', sans-serif;
    font-size: 1rem;
}

.btn-download:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(99, 102, 241, 0.3);
}

.popular-packages {
    background: white;
    border-radius: 20px;
    padding: 32px;
    margin-bottom: 32px;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.08);
}

.popular-packages h2 {
    font-family: 'Cantora One', sans-serif;
    font-size: 1.8rem;
    text-align: center;
    margin-bottom: 24px;
    background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.packages-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: 20px;
}

.package-card {
    border: 2px solid var(--gray-200);
    border-radius: 16px;
    padding: 20px;
    cursor: pointer;
    transition: all 0.3s;
    background: white;
    position: relative;
}

.package-card:hover {
    border-color: var(--primary);
    transform: translateY(-4px);
    box-shadow: 0 12px 30px rgba(16, 185, 129, 0.2);
}

.package-card.trending::before {
    content: 'üî• 2026 Trending';
    position: absolute;
    top: -10px;
    right: 20px;
    background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
    color: white;
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 0.75rem;
    font-weight: 600;
}

.package-badge {
    display: inline-block;
    background: linear-gradient(135deg, var(--secondary) 0%, var(--secondary-dark) 100%);
    color: white;
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 0.75rem;
    font-weight: 600;
    margin-bottom: 12px;
}

.package-title { font-size: 1.3rem; font-weight: 700; color: var(--gray-800); margin-bottom: 8px; }

.package-details {
    display: flex;
    gap: 16px;
    margin: 12px 0;
    font-size: 0.9rem;
    color: var(--gray-600);
    flex-wrap: wrap;
}

.package-price { font-size: 1.5rem; font-weight: 700; color: var(--primary); margin: 12px 0; }
.package-price small { font-size: 0.9rem; color: var(--gray-500); font-weight: 400; }
.package-price .original { text-decoration: line-through; color: var(--gray-400); font-size: 1rem; margin-right: 8px; }

.package-highlights { list-style: none; padding: 0; margin: 12px 0; }

.package-highlights li {
    padding: 6px 0;
    font-size: 0.85rem;
    color: var(--gray-600);
    display: flex;
    align-items: center;
    gap: 8px;
}

.package-highlights li::before { content: '‚úì'; color: var(--primary); font-weight: bold; }

.testimonials-section {
    background: white;
    border-radius: 20px;
    padding: 32px;
    margin-bottom: 32px;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.08);
}

.testimonials-section h2 {
    font-family: 'Cantora One', sans-serif;
    font-size: 1.8rem;
    text-align: center;
    margin-bottom: 24px;
    color: var(--gray-800);
}

.testimonials-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 20px;
}

.testimonial-card {
    background: linear-gradient(135deg, #f0fdf4 0%, #ecfdf5 100%);
    border-radius: 16px;
    padding: 24px;
    border-left: 4px solid var(--primary);
}

.testimonial-header { display: flex; align-items: center; gap: 16px; margin-bottom: 16px; }

.testimonial-avatar {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1.5rem;
    font-weight: bold;
}

.testimonial-info h4 { margin: 0; color: var(--gray-800); font-size: 1.1rem; }
.testimonial-info p { margin: 4px 0 0; color: var(--gray-600); font-size: 0.85rem; }
.testimonial-rating { color: #f59e0b; font-size: 1rem; margin-bottom: 12px; }
.testimonial-text { color: var(--gray-700); line-height: 1.6; font-size: 0.95rem; font-style: italic; }

.testimonial-trip {
    margin-top: 12px;
    padding-top: 12px;
    border-top: 1px solid var(--gray-200);
    font-size: 0.85rem;
    color: var(--gray-600);
}

.loading-spinner { text-align: center; padding: 60px; }
.loading-spinner .spinner { 
    font-size: 3rem; 
    animation: spin 1s linear infinite; 
    display: inline-block;
}

.form-row {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 16px;
}

.includes-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 20px;
}

.includes-item h4 {
    color: var(--primary);
    margin-bottom: 12px;
    font-size: 1rem;
}

.includes-item ul {
    list-style: none;
    padding: 0;
    font-size: 0.9rem;
    color: var(--gray-700);
    line-height: 2;
}

.includes-item ul li::before {
    content: '‚úÖ ';
}

.save-indicator {
    position: fixed;
    bottom: 20px;
    left: 20px;
    background: var(--primary);
    color: white;
    padding: 12px 20px;
    border-radius: 50px;
    box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
    font-weight: 600;
    font-size: 0.9rem;
    display: none;
    z-index: 1000;
}

.save-indicator.show {
    display: block;
    animation: slideInUp 0.3s;
}

.transfer-breakdown {
    background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
    border-radius: 12px;
    padding: 20px;
    margin: 16px 0;
    border-left: 4px solid #0ea5e9;
}

.transfer-breakdown h4 {
    color: #0369a1;
    margin-bottom: 12px;
    font-size: 1rem;
}

.transfer-item {
    display: flex;
    justify-content: space-between;
    padding: 8px 0;
    border-bottom: 1px dashed #bae6fd;
    font-size: 0.9rem;
}

.transfer-item:last-child { border-bottom: none; }
.transfer-route { color: var(--gray-700); }
.transfer-price { color: #0369a1; font-weight: 600; }

.activity-breakdown {
    background: linear-gradient(135deg, #fdf4ff 0%, #fae8ff 100%);
    border-radius: 12px;
    padding: 20px;
    margin: 16px 0;
    border-left: 4px solid #a855f7;
}

.activity-breakdown h4 {
    color: #7e22ce;
    margin-bottom: 12px;
    font-size: 1rem;
}

.activity-item {
    display: flex;
    justify-content: space-between;
    padding: 8px 0;
    border-bottom: 1px dashed #e9d5ff;
    font-size: 0.9rem;
}

.activity-item:last-child { border-bottom: none; }
.activity-name-small { color: var(--gray-700); }
.activity-price-small { color: #7e22ce; font-weight: 600; }

@keyframes fadeInDown {
    from { opacity: 0; transform: translateY(-20px); }
    to { opacity: 1; transform: translateY(0); }
}

@keyframes fadeInUp {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

@keyframes spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}

@keyframes slideInUp {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

@media (max-width: 768px) {
    body { padding: 12px; }
    .header h1 { font-size: 1.8rem; }
    .planner-card { padding: 20px; }
    .step-label { font-size: 0.7rem; }
    .destination-grid { grid-template-columns: 1fr; }
    .button-group { flex-direction: column; }
    .btn { width: 100%; }
    .trip-summary { grid-template-columns: repeat(2, 1fr); }
    .packages-grid { grid-template-columns: 1fr; }
    .testimonials-grid { grid-template-columns: 1fr; }
    .emi-inputs { grid-template-columns: 1fr; }
    .download-buttons { flex-direction: column; }
    .btn-download { width: 100%; justify-content: center; }
    .cta-section { grid-template-columns: 1fr; }
    .flight-cta { grid-template-columns: 1fr; }
    .offer-banner::before, .offer-banner::after { display: none; }
    .currency-converter { flex-direction: column; }
}

@media print {
    body { background: white; padding: 0; }
    .planner-card { box-shadow: none; padding: 20px; }
    .cta-section, .emi-calculator, .download-buttons, .btn, .rating-section { display: none !important; }
}
</style>
</head>
<body>
<div class="container">
    <!-- Limited Time Offer Banner -->
    <div class="offer-banner" id="offerBanner">
        <h3>üéÅ Limited Time Offer - Book Now & Save!</h3>
        <p>Get <strong>5% OFF</strong> on all land packages for Jan-Feb 2026 travel</p>
        <div class="offer-countdown">‚è∞ Offer ends in: <span id="countdown">23:59:59</span></div>
    </div>

    <div class="header">
        <h1>‚úàÔ∏è Plan Your Perfect Trip 2026</h1>
        <p style="font-size: 1.25rem; margin-bottom: 16px;">Create your dream itinerary - <strong style="color: var(--primary);">AI-Powered Smart Suggestions!</strong></p>
        <p style="font-size: 1rem; color: var(--gray-600);">üåç Real prices ‚Ä¢ Smart warnings ‚Ä¢ Interest-based recommendations</p>
        <div class="trust-badges">
            <div class="trust-badge">‚≠ê <strong>4.8/5</strong> (500+ reviews)</div>
            <div class="trust-badge">‚úÖ <strong>12,000+</strong> Happy travelers</div>
            <div class="trust-badge">üéØ <strong>90-98%</strong> Visa success</div>
            <div class="trust-badge">üí≥ <strong>0% EMI</strong> Available</div>
        </div>
    </div>

    <!-- Currency Converter -->
    <div class="currency-converter">
        <h4>üí± Live Exchange Rates (BDT):</h4>
        <div class="currency-rates">
            <div class="currency-rate">
                <span class="flag">üá∫üá∏</span>
                <span>1 USD =</span>
                <span class="rate" id="rateUSD">‡ß≥120</span>
            </div>
            <div class="currency-rate">
                <span class="flag">üá∏üá¨</span>
                <span>1 SGD =</span>
                <span class="rate" id="rateSGD">‡ß≥89</span>
            </div>
            <div class="currency-rate">
                <span class="flag">üá≤üáæ</span>
                <span>1 MYR =</span>
                <span class="rate" id="rateMYR">‡ß≥28</span>
            </div>
            <div class="currency-rate">
                <span class="flag">üáπüá≠</span>
                <span>1 THB =</span>
                <span class="rate" id="rateTHB">‡ß≥3.5</span>
            </div>
            <div class="currency-rate">
                <span class="flag">üá¶üá™</span>
                <span>1 AED =</span>
                <span class="rate" id="rateAED">‡ß≥33</span>
            </div>
        </div>
    </div>

    <!-- Interactive Map -->
    <div class="map-container" id="mapContainer">
        <h3>üó∫Ô∏è Your Trip Route</h3>
        <div id="tripMap"></div>
    </div>

    <!-- Interest Selector -->
    <div class="interest-selector" id="interestSelector">
        <h4>üéØ What type of experience are you looking for?</h4>
        <div class="interest-chips">
            <div class="interest-chip" onclick="selectInterest('beach', this)" data-interest="beach">
                <span class="icon">üèñÔ∏è</span> Beach & Relaxation
            </div>
            <div class="interest-chip" onclick="selectInterest('adventure', this)" data-interest="adventure">
                <span class="icon">üèîÔ∏è</span> Adventure
            </div>
            <div class="interest-chip" onclick="selectInterest('culture', this)" data-interest="culture">
                <span class="icon">üèõÔ∏è</span> Culture & Heritage
            </div>
            <div class="interest-chip" onclick="selectInterest('shopping', this)" data-interest="shopping">
                <span class="icon">üõçÔ∏è</span> Shopping & City
            </div>
            <div class="interest-chip" onclick="selectInterest('romantic', this)" data-interest="romantic">
                <span class="icon">üíë</span> Romantic / Honeymoon
            </div>
            <div class="interest-chip" onclick="selectInterest('family', this)" data-interest="family">
                <span class="icon">üë®‚Äçüë©‚Äçüëß‚Äçüë¶</span> Family Fun
            </div>
        </div>
    </div>

    <!-- Recommended Combos -->
    <div class="recommended-combos" id="recommendedCombos">
        <h4>üí° Recommended for you (based on your interest)</h4>
        <div class="combo-chips" id="comboChips">
            <div class="combo-chip trending" onclick="selectCombo(['Thailand', 'Malaysia'], 7)">
                üáπüá≠üá≤üáæ Thailand + Malaysia (7D)
            </div>
            <div class="combo-chip" onclick="selectCombo(['Singapore', 'Malaysia'], 7)">
                üá∏üá¨üá≤üáæ Singapore + Malaysia (7D)
            </div>
            <div class="combo-chip trending" onclick="selectCombo(['Indonesia', 'Singapore'], 8)">
                üáÆüá©üá∏üá¨ Bali + Singapore (8D) 
            </div>
            <div class="combo-chip" onclick="selectCombo(['Vietnam', 'Thailand'], 10)">
                üáªüá≥üáπüá≠ Vietnam + Thailand (10D)
            </div>
        </div>
    </div>

    <div class="popular-packages" id="popularPackages">
        <h2>üî• Best-Selling Packages 2026 (Land Only)</h2>
        <p style="text-align: center; color: var(--gray-600); margin-bottom: 24px;">
            Updated prices for 2026 ‚Ä¢ <span style="color: var(--secondary); font-weight: 600;">5% Early Bird Discount!</span>
        </p>
        <div class="packages-grid">
            <div class="package-card trending" onclick="selectPopularPackage(['Thailand', 'Malaysia'], 7)">
                <span class="package-badge">üèÜ BEST SELLER</span>
                <div class="package-title">üáπüá≠üá≤üáæ Thailand + Malaysia</div>
                <div class="package-details">
                    <span>üìÖ 7 Days / 6 Nights</span>
                    <span>‚úàÔ∏è 2 Countries</span>
                </div>
                <div class="package-price">
                    <span class="original">‡ß≥45,000</span>
                    ‡ß≥42,750 <small>per person</small>
                </div>
                <ul class="package-highlights">
                    <li>Bangkok + Pattaya + Kuala Lumpur</li>
                    <li>Grand Palace, Petronas Towers</li>
                    <li>All transfers + activities included</li>
                </ul>
            </div>

            <div class="package-card" onclick="selectPopularPackage(['Indonesia', 'Singapore'], 8)">
                <span class="package-badge">üå¥ 2026 TRENDING</span>
                <div class="package-title">üáÆüá©üá∏üá¨ Bali + Singapore</div>
                <div class="package-details">
                    <span>üìÖ 8 Days / 7 Nights</span>
                    <span>‚úàÔ∏è 2 Countries</span>
                </div>
                <div class="package-price">
                    <span class="original">‡ß≥62,000</span>
                    ‡ß≥58,900 <small>per person</small>
                </div>
                <ul class="package-highlights">
                    <li>Ubud + Seminyak + Singapore</li>
                    <li>Rice terraces + Universal Studios</li>
                    <li>Best of nature + city</li>
                </ul>
            </div>

            <div class="package-card" onclick="selectPopularPackage(['Thailand'], 5)">
                <span class="package-badge">üí∞ BUDGET PICK</span>
                <div class="package-title">üáπüá≠ Thailand Explorer</div>
                <div class="package-details">
                    <span>üìÖ 5 Days / 4 Nights</span>
                    <span>‚úàÔ∏è 1 Country</span>
                </div>
                <div class="package-price">
                    <span class="original">‡ß≥30,000</span>
                    ‡ß≥28,500 <small>per person</small>
                </div>
                <ul class="package-highlights">
                    <li>Bangkok + Pattaya</li>
                    <li>Temples, Beach & Nightlife</li>
                    <li>Perfect first international trip</li>
                </ul>
            </div>

            <div class="package-card" onclick="selectPopularPackage(['Maldives'], 4)">
                <span class="package-badge">üíë HONEYMOON</span>
                <div class="package-title">üá≤üáª Maldives Paradise</div>
                <div class="package-details">
                    <span>üìÖ 4 Days / 3 Nights</span>
                    <span>üèùÔ∏è Resort Stay</span>
                </div>
                <div class="package-price">
                    <span class="original">‡ß≥85,000</span>
                    ‡ß≥80,750 <small>per person</small>
                </div>
                <ul class="package-highlights">
                    <li>Water Villa accommodation</li>
                    <li>Snorkeling + Dolphin cruise</li>
                    <li>All meals included</li>
                </ul>
            </div>

            <div class="package-card" onclick="selectPopularPackage(['Thailand', 'Malaysia', 'Singapore'], 10)">
                <span class="package-badge">üåç GRAND TOUR</span>
                <div class="package-title">üáπüá≠üá≤üáæüá∏üá¨ SEA Triple</div>
                <div class="package-details">
                    <span>üìÖ 10 Days / 9 Nights</span>
                    <span>‚úàÔ∏è 3 Countries</span>
                </div>
                <div class="package-price">
                    <span class="original">‡ß≥92,000</span>
                    ‡ß≥87,400 <small>per person</small>
                </div>
                <ul class="package-highlights">
                    <li>Bangkok + KL + Singapore</li>
                    <li>Complete SEA experience</li>
                    <li>All visas by goFLY</li>
                </ul>
            </div>

            <div class="package-card" onclick="selectPopularPackage(['Dubai'], 5)">
                <span class="package-badge">üëë LUXURY</span>
                <div class="package-title">üá¶üá™ Dubai Deluxe</div>
                <div class="package-details">
                    <span>üìÖ 5 Days / 4 Nights</span>
                    <span>‚úàÔ∏è 1 Country</span>
                </div>
                <div class="package-price">
                    <span class="original">‡ß≥58,000</span>
                    ‡ß≥55,100 <small>per person</small>
                </div>
                <ul class="package-highlights">
                    <li>Dubai + Abu Dhabi</li>
                    <li>Burj Khalifa, Desert Safari</li>
                    <li>4-star hotel included</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="testimonials-section" id="testimonials">
        <h2>üí¨ Recent Traveler Reviews (2024-25)</h2>
        <div class="testimonials-grid">
            <div class="testimonial-card">
                <div class="testimonial-header">
                    <div class="testimonial-avatar">RS</div>
                    <div class="testimonial-info">
                        <h4>Rafiq & Sabrina</h4>
                        <p>Dhaka ‚Ä¢ Verified Purchase</p>
                    </div>
                </div>
                <div class="testimonial-rating">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                <div class="testimonial-text">"Thailand + Malaysia was PERFECT for our honeymoon! The warning about 3 countries being too rushed was spot on - 2 countries in 7 days was ideal."</div>
                <div class="testimonial-trip">üáπüá≠üá≤üáæ Thailand + Malaysia ‚Ä¢ 7 Days ‚Ä¢ Nov 2024</div>
            </div>

            <div class="testimonial-card">
                <div class="testimonial-header">
                    <div class="testimonial-avatar">KH</div>
                    <div class="testimonial-info">
                        <h4>Kamal Hossain</h4>
                        <p>Chittagong ‚Ä¢ Verified Purchase</p>
                    </div>
                </div>
                <div class="testimonial-rating">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                <div class="testimonial-text">"The add-ons feature helped me customize exactly what I wanted. Desert Safari in Dubai was amazing! No hidden costs at all."</div>
                <div class="testimonial-trip">üá¶üá™ Dubai Deluxe ‚Ä¢ 5 Days ‚Ä¢ Dec 2024</div>
            </div>

            <div class="testimonial-card">
                <div class="testimonial-header">
                    <div class="testimonial-avatar">FA</div>
                    <div class="testimonial-info">
                        <h4>Fatima Akter</h4>
                        <p>Sylhet ‚Ä¢ Verified Purchase</p>
                    </div>
                </div>
                <div class="testimonial-rating">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                <div class="testimonial-text">"Bali + Singapore was the BEST combo! The trip planner suggested it when I selected 'Beach + City' interest. So smart!"</div>
                <div class="testimonial-trip">üáÆüá©üá∏üá¨ Bali + Singapore ‚Ä¢ 8 Days ‚Ä¢ Jan 2025</div>
            </div>
        </div>
    </div>

    <div class="planner-card">
        <div class="step-indicator" id="stepIndicator">
            <div class="step active" data-step="1">
                <div class="step-number">1</div>
                <div class="step-label">Destinations</div>
            </div>
            <div class="step" data-step="2">
                <div class="step-number">2</div>
                <div class="step-label">Details</div>
            </div>
            <div class="step" data-step="3">
                <div class="step-number">3</div>
                <div class="step-label">Add-ons</div>
            </div>
            <div class="step" data-step="4">
                <div class="step-number">4</div>
                <div class="step-label">Contact</div>
            </div>
        </div>

        <!-- Step 1: Destinations -->
        <div class="form-section active" data-section="1">
            <div class="form-group">
                <label>üåç Select Your Destination(s) <span style="font-weight: 400; color: var(--gray-500);">(Max 4)</span></label>
                <div class="destination-grid" id="destinationGrid"></div>
            </div>

            <!-- Smart Warning -->
            <div class="smart-warning" id="smartWarning">
                <h4>‚ö†Ô∏è Heads Up! This Might Be Too Rushed</h4>
                <p id="warningText">3+ countries in 7 days means 2+ travel days lost. Reviews show travelers feel exhausted. We recommend 10+ days for a better experience.</p>
                <div class="suggestion-buttons">
                    <button class="btn-suggest btn-extend" onclick="extendDuration()">‚úÖ Extend to 10 Days</button>
                    <button class="btn-suggest btn-keep" onclick="keepCurrent()">Keep Current Selection</button>
                </div>
            </div>

            <div id="selectedDestinationsBox" style="display: none;" class="selected-destinations">
                <h4>‚úÖ Selected Destinations (<span id="selectedCount">0</span>)</h4>
                <div class="selected-list" id="selectedList"></div>
            </div>

            <div class="button-group">
                <button class="btn btn-primary" onclick="nextStep()" id="step1Next" disabled>Continue ‚Üí</button>
            </div>
        </div>

        <!-- Step 2: Trip Details -->
        <div class="form-section" data-section="2">
            <div class="form-group">
                <label>üìÖ Trip Duration</label>
                <select id="duration" required onchange="updateDurationNote()">
                    <option value="">Select duration</option>
                    <option value="3" id="duration3">3 Days / 2 Nights</option>
                    <option value="4" id="duration4">4 Days / 3 Nights</option>
                    <option value="5" id="duration5">5 Days / 4 Nights</option>
                    <option value="7" id="duration7">7 Days / 6 Nights ‚≠ê Popular</option>
                    <option value="10" id="duration10">10 Days / 9 Nights ‚≠ê Recommended</option>
                    <option value="14" id="duration14">14 Days / 13 Nights</option>
                </select>
                <div id="durationNote" style="margin-top: 12px; padding: 16px; background: linear-gradient(135deg, #f0fdf4 0%, #ecfdf5 100%); border-radius: 12px; font-size: 0.9rem; color: var(--gray-700); display: none; border-left: 4px solid var(--primary);"></div>
                <div id="durationWarning" style="margin-top: 8px; padding: 12px; background: #fef3c7; border-radius: 8px; font-size: 0.9rem; color: #92400e; display: none;">
                    ‚ö†Ô∏è For multi-country trips, we recommend at least <span id="recommendedDays">7</span> days.
                </div>
            </div>

            <div class="form-group">
                <label>üë• Number of Travelers</label>
                <div class="form-row">
                    <div>
                        <input type="number" id="adults" placeholder="Adults (12+)" min="1" max="20" value="2" required>
                    </div>
                    <div>
                        <input type="number" id="children" placeholder="Children (2-11)" min="0" max="10" value="0">
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label>üóìÔ∏è Preferred Travel Date</label>
                <input type="date" id="travelDate" required onchange="checkPeakSeason2026()">
                
                <!-- Peak Season 2026 Info -->
                <div class="peak-season-2026" id="peakSeason2026">
                    <h5>üî• Peak Season Dates 2026 (Higher Prices Expected)</h5>
                    <div class="peak-dates">
                        <div class="peak-date">
                            <span class="date">üßß Chinese New Year</span><br>
                            Feb 17-23, 2026
                        </div>
                        <div class="peak-date">
                            <span class="date">üí¶ Songkran (Thai)</span><br>
                            Apr 13-17, 2026
                        </div>
                        <div class="peak-date">
                            <span class="date">üéÑ Christmas/NY</span><br>
                            Dec 20 - Jan 5
                        </div>
                        <div class="peak-date">
                            <span class="date">‚òÄÔ∏è Summer</span><br>
                            Jun 15 - Aug 31
                        </div>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label>üí∞ Budget Range</label>
                <div class="budget-options">
                    <div class="budget-option" onclick="selectBudget('economy', this)">
                        <div class="icon">üí∞</div>
                        <h3>Economy</h3>
                        <p>3‚òÖ Hotels, Budget-friendly</p>
                    </div>
                    <div class="budget-option selected" onclick="selectBudget('standard', this)">
                        <div class="icon">‚≠ê</div>
                        <h3>Standard</h3>
                        <p>4‚òÖ Hotels, Best Value</p>
                    </div>
                    <div class="budget-option" onclick="selectBudget('premium', this)">
                        <div class="icon">üëë</div>
                        <h3>Premium</h3>
                        <p>5‚òÖ Hotels, Luxury</p>
                    </div>
                </div>
            </div>

            <div class="button-group">
                <button class="btn btn-secondary" onclick="prevStep()">‚Üê Back</button>
                <button class="btn btn-primary" onclick="nextStep()">Continue ‚Üí</button>
            </div>
        </div>

        <!-- Step 3: Add-ons -->
        <div class="form-section" data-section="3">
            <div class="addons-section">
                <h4>‚ûï Optional Add-ons (Customize Your Experience)</h4>
                <p style="color: var(--gray-600); font-size: 0.9rem; margin-bottom: 16px;">Select additional tours and services. Prices are per person unless noted.</p>
                
                <div class="addons-grid" id="addonsGrid">
                    <!-- Will be populated dynamically -->
                </div>
                
                <div class="addons-total">
                    <span class="total-label">Selected Add-ons Total:</span>
                    <span class="total-amount" id="addonsTotal">‡ß≥0</span>
                </div>
            </div>

            <div class="button-group">
                <button class="btn btn-secondary" onclick="prevStep()">‚Üê Back</button>
                <button class="btn btn-primary" onclick="nextStep()">Continue ‚Üí</button>
            </div>
        </div>

        <!-- Step 4: Contact Info -->
        <div class="form-section" data-section="4">
            <div class="form-group">
                <label>üë§ Your Name *</label>
                <input type="text" id="userName" placeholder="Enter your full name" required>
                <div class="error-message" id="nameError">Please enter your name</div>
            </div>

            <div class="form-group">
                <label>üì± Mobile Number *</label>
                <input type="tel" id="userPhone" placeholder="01XXXXXXXXX" maxlength="11" required>
                <div class="error-message" id="phoneError">Please enter a valid 11-digit number starting with 01</div>
            </div>

            <div class="form-group">
                <label>‚úâÔ∏è Email (Optional)</label>
                <input type="email" id="userEmail" placeholder="your@email.com">
                <div class="error-message" id="emailError">Please enter a valid email</div>
            </div>

                        <div class="form-group">
                <label>üìù Special Requests (Optional)</label>
                <input type="text" id="specialNotes" placeholder="Any special requirements? (e.g., wheelchair access, dietary restrictions, anniversary celebration)">
            </div>

            <div class="button-group">
                <button class="btn btn-secondary" onclick="prevStep()">‚Üê Back</button>
                <button class="btn btn-primary" onclick="generateItinerary()">‚ú® Generate My Itinerary</button>
            </div>
        </div>

        <!-- Results -->
        <div class="itinerary-result" id="itineraryResult"></div>
    </div>
</div>

<!-- WhatsApp Floating Button -->
<a href="https://wa.me/8801713289178" id="whatsappFloat" style="position: fixed; bottom: 30px; right: 30px; width: 60px; height: 60px; background: linear-gradient(135deg, #25d366 0%, #128c7e 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 30px; box-shadow: 0 4px 20px rgba(37, 211, 102, 0.4); z-index: 1000; text-decoration: none; transition: all 0.3s;" target="_blank" onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform='scale(1)'">üí¨</a>

<!-- Save Indicator -->
<div class="save-indicator" id="saveIndicator">üíæ Auto-saved</div>

<!-- Leaflet Map JS -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
// ==================== DESTINATION DATABASE WITH 2026 PRICES ====================
const destinations = {
    'Thailand': {
        flag: 'üáπüá≠',
        image: 'https://images.unsplash.com/photo-1508009603885-50cf7c579365?w=800&q=80',
        images: [
            'https://images.unsplash.com/photo-1508009603885-50cf7c579365?w=800&q=80',
            'https://images.unsplash.com/photo-1552465011-b4e21bf6e79a?w=800&q=80',
            'https://images.unsplash.com/photo-1506665531195-3566af2b4dfa?w=800&q=80'
        ],
        category: 'Culture & Beach',
        tags: ['beach', 'culture', 'shopping', 'family'],
        coordinates: [13.7563, 100.5018],
        visaGuideUrl: 'https://goflybd.com/thailand-visa-bangladesh/',
        visaType: 'Tourist Visa (95% success)',
        visaFee: 6500,
        hotelBudget: 5000,
        hotelStandard: 9500,
        hotelLuxury: 18000,
        transfers: {
            'BKK ‚Üí Bangkok City': { price: 6500, time: '45-60 min' },
            'Bangkok ‚Üí Pattaya': { price: 5500, time: '2 hours' },
            'BKK ‚Üí Phuket': { price: 13000, time: '1.5-2 hours' },
            'BKK ‚Üí Krabi': { price: 16000, time: '2-3 hours' }
        },
        activities: {
            'Grand Palace + Wat Phra Kaew': { price: 2200, duration: '3 hours', city: 'Bangkok' },
            'Grand Palace + Wat Pho + Wat Arun Tour': { price: 8000, duration: '5 hours', city: 'Bangkok' },
            'Chatuchak Market': { price: 0, duration: '4 hours', city: 'Bangkok' },
            'Chao Phraya River Cruise': { price: 4000, duration: '2 hours', city: 'Bangkok' },
            'Coral Island (Koh Larn) Trip': { price: 5500, duration: 'Full day', city: 'Pattaya' },
            'Alcazar Cabaret Show': { price: 4000, duration: '2 hours', city: 'Pattaya' },
            'Phi Phi Islands Day Trip': { price: 11000, duration: 'Full day', city: 'Phuket' },
            'Four Islands Tour': { price: 6500, duration: 'Full day', city: 'Krabi' }
        },
        addons: [
            { id: 'th_floating', name: 'Floating Market Tour', desc: 'Damnoen Saduak + Train Market', price: 3500 },
            { id: 'th_massage', name: 'Thai Spa Package', desc: '2-hour traditional massage', price: 2500 },
            { id: 'th_muaythai', name: 'Muay Thai Show', desc: 'Live boxing match experience', price: 2000 },
            { id: 'th_cooking', name: 'Thai Cooking Class', desc: 'Learn to cook 5 dishes', price: 3000 }
        ],
        cities: [
            { name: 'Bangkok', days: 3, attractions: ['Grand Palace + Wat Phra Kaew', 'Chatuchak Market', 'Chao Phraya River Cruise'] },
            { name: 'Pattaya', days: 2, attractions: ['Coral Island (Koh Larn) Trip', 'Alcazar Cabaret Show'] },
            { name: 'Phuket', days: 3, attractions: ['Phi Phi Islands Day Trip'] },
            { name: 'Krabi', days: 2, attractions: ['Four Islands Tour'] }
        ]
    },
    'Malaysia': {
        flag: 'üá≤üáæ',
        image: 'https://images.unsplash.com/photo-1596422846543-75c6fc197f07?w=800&q=80',
        images: [
            'https://images.unsplash.com/photo-1596422846543-75c6fc197f07?w=800&q=80',
            'https://images.unsplash.com/photo-1508062878650-88b52897f298?w=800&q=80'
        ],
        category: 'Shopping & Culture',
        tags: ['shopping', 'culture', 'family'],
        coordinates: [3.139, 101.6869],
        visaGuideUrl: 'https://goflybd.com/malaysia-visa/',
        visaType: 'eVisa (98% success)',
        visaFee: 6000,
        hotelBudget: 6000,
        hotelStandard: 11000,
        hotelLuxury: 22000,
        transfers: {
            'KLIA ‚Üí Kuala Lumpur City': { price: 6000, time: '50-70 min' },
            'KLIA ‚Üí Genting Highlands': { price: 12000, time: '1.5-2 hours' }
        },
        activities: {
            'Petronas Twin Towers': { price: 2800, duration: '2 hours', city: 'Kuala Lumpur' },
            'Batu Caves + City Tour': { price: 7000, duration: '5 hours', city: 'Kuala Lumpur' },
            'Genting Day Trip': { price: 11000, duration: 'Full day', city: 'Genting' }
        },
        addons: [
            { id: 'my_genting', name: 'Genting Theme Park Pass', desc: 'Full day unlimited rides', price: 8000 },
            { id: 'my_aquaria', name: 'Aquaria KLCC', desc: 'Underwater tunnel experience', price: 2000 },
            { id: 'my_firefly', name: 'Firefly Tour', desc: 'Magical night river cruise', price: 4500 }
        ],
        cities: [
            { name: 'Kuala Lumpur', days: 3, attractions: ['Petronas Twin Towers', 'Batu Caves + City Tour'] },
            { name: 'Genting Highlands', days: 1, attractions: ['Genting Day Trip'] }
        ]
    },
    'Singapore': {
        flag: 'üá∏üá¨',
        image: 'https://images.unsplash.com/photo-1525625293386-3f8f99389edd?w=800&q=80',
        images: [
            'https://images.unsplash.com/photo-1525625293386-3f8f99389edd?w=800&q=80',
            'https://images.unsplash.com/photo-1565967511849-76a60a516170?w=800&q=80'
        ],
        category: 'City Experience',
        tags: ['shopping', 'family', 'culture'],
        coordinates: [1.3521, 103.8198],
        visaGuideUrl: 'https://goflybd.com/singapore-visa/',
        visaType: 'Tourist Visa (95% success)',
        visaFee: 8500,
        hotelBudget: 13000,
        hotelStandard: 24000,
        hotelLuxury: 45000,
        transfers: {
            'Changi ‚Üí City Center': { price: 6000, time: '25-45 min' },
            'Changi ‚Üí Sentosa': { price: 8000, time: '30-50 min' }
        },
        activities: {
            'Gardens by the Bay': { price: 6000, duration: '3 hours', city: 'Singapore' },
            'Universal Studios Singapore': { price: 9000, duration: 'Full day', city: 'Sentosa' },
            'Marina Bay Sands SkyPark': { price: 3500, duration: '1.5 hours', city: 'Singapore' },
            'Singapore Zoo + Night Safari': { price: 7500, duration: '6 hours', city: 'Singapore' }
        },
        addons: [
            { id: 'sg_zoo', name: 'Night Safari', desc: 'World-famous nocturnal zoo', price: 5500 },
            { id: 'sg_flyer', name: 'Singapore Flyer', desc: 'Giant observation wheel', price: 3500 },
            { id: 'sg_cruise', name: 'Marina Bay Dinner Cruise', desc: '2-hour sunset dinner', price: 7000 },
            { id: 'sg_cable', name: 'Sentosa Cable Car', desc: 'Round trip scenic ride', price: 3000 }
        ],
        cities: [
            { name: 'Singapore', days: 5, attractions: ['Gardens by the Bay', 'Universal Studios Singapore', 'Marina Bay Sands SkyPark'] }
        ]
    },
    'Indonesia': {
        flag: 'üáÆüá©',
        image: 'https://images.unsplash.com/photo-1555400038-63f5ba517a47?w=800&q=80',
        images: [
            'https://images.unsplash.com/photo-1555400038-63f5ba517a47?w=800&q=80',
            'https://images.unsplash.com/photo-1537996194471-e657df975ab4?w=800&q=80'
        ],
        category: 'Beach & Culture',
        tags: ['beach', 'culture', 'adventure', 'romantic'],
        coordinates: [-8.4095, 115.1889],
        visaGuideUrl: 'https://goflybd.com/indonesia-visa/',
        visaType: 'Visa on Arrival',
        visaFee: 6500,
        hotelBudget: 4500,
        hotelStandard: 10000,
        hotelLuxury: 20000,
        transfers: {
            'DPS ‚Üí Seminyak': { price: 3500, time: '45-60 min' },
            'DPS ‚Üí Ubud': { price: 5000, time: '1-1.5 hours' }
        },
        activities: {
            'Ubud Monkey Forest + Rice Terraces': { price: 5000, duration: '5 hours', city: 'Ubud' },
            'Tanah Lot + Uluwatu Temple': { price: 7500, duration: 'Full day', city: 'Bali' },
            'Nusa Penida Day Trip': { price: 11000, duration: 'Full day', city: 'Bali' }
        },
        addons: [
            { id: 'id_swing', name: 'Bali Swing Experience', desc: 'Instagram-famous jungle swing', price: 3500 },
            { id: 'id_rafting', name: 'Ayung River Rafting', desc: '2-hour white water adventure', price: 5000 },
            { id: 'id_sunrise', name: 'Mount Batur Sunrise Trek', desc: 'Early morning volcano hike', price: 6000 },
            { id: 'id_spa', name: 'Balinese Spa Package', desc: '3-hour luxury treatment', price: 4500 }
        ],
        cities: [
            { name: 'Bali', days: 6, attractions: ['Ubud Monkey Forest + Rice Terraces', 'Tanah Lot + Uluwatu Temple', 'Nusa Penida Day Trip'] }
        ]
    },
    'Nepal': {
        flag: 'üá≥üáµ',
        image: 'https://images.unsplash.com/photo-1609137144813-7d9921338f24?w=800&q=80',
        images: [
            'https://images.unsplash.com/photo-1609137144813-7d9921338f24?w=800&q=80'
        ],
        category: 'Adventure & Nature',
        tags: ['adventure', 'culture'],
        coordinates: [27.7172, 85.324],
        visaGuideUrl: 'https://goflybd.com/nepal-visa/',
        visaType: 'Online eVisa',
        visaFee: 5500,
        hotelBudget: 4000,
        hotelStandard: 8000,
        hotelLuxury: 15000,
        transfers: {
            'KTM ‚Üí Kathmandu City': { price: 1800, time: '30-45 min' },
            'Kathmandu ‚Üí Pokhara': { price: 22000, time: '6-7 hours' }
        },
        activities: {
            'Kathmandu Valley Sightseeing': { price: 4500, duration: 'Full day', city: 'Kathmandu' },
            'Sarangkot Sunrise + Phewa Lake': { price: 4000, duration: '5 hours', city: 'Pokhara' },
            'Chitwan Jungle Safari': { price: 9000, duration: 'Full day', city: 'Chitwan' }
        },
        addons: [
            { id: 'np_everest', name: 'Everest Scenic Flight', desc: '1-hour mountain flight', price: 22000 },
            { id: 'np_paragliding', name: 'Paragliding Pokhara', desc: '30-min tandem flight', price: 8000 },
            { id: 'np_rafting', name: 'River Rafting', desc: 'Half-day Trisuli rapids', price: 5500 }
        ],
        cities: [
            { name: 'Kathmandu', days: 2, attractions: ['Kathmandu Valley Sightseeing'] },
            { name: 'Pokhara', days: 3, attractions: ['Sarangkot Sunrise + Phewa Lake'] },
            { name: 'Chitwan', days: 2, attractions: ['Chitwan Jungle Safari'] }
        ]
    },
    'Maldives': {
        flag: 'üá≤üáª',
        image: 'https://images.unsplash.com/photo-1573843981267-be1999ff37cd?w=800&q=80',
        images: [
            'https://images.unsplash.com/photo-1573843981267-be1999ff37cd?w=800&q=80',
            'https://images.unsplash.com/photo-1514282401047-d79a71a590e8?w=800&q=80'
        ],
        category: 'Beach Paradise',
        tags: ['beach', 'romantic'],
        coordinates: [3.2028, 73.2207],
        visaGuideUrl: 'https://goflybd.com/maldives-visa/',
        visaType: 'Visa on Arrival (Free)',
        visaFee: 0,
        hotelBudget: 18000,
        hotelStandard: 40000,
        hotelLuxury: 85000,
        transfers: {
            'MLE ‚Üí Resort (Speedboat)': { price: 20000, time: '15-90 min', perPerson: true }
        },
        activities: {
            'Snorkeling + Dolphin Cruise': { price: 15000, duration: '4 hours', city: 'Resort', perPerson: true },
            'Sunset Cruise + Sandbank': { price: 20000, duration: '3 hours', city: 'Resort', perPerson: true }
        },
        addons: [
            { id: 'mv_diving', name: 'Scuba Diving (2 dives)', desc: 'Certified instructor included', price: 18000 },
            { id: 'mv_spa', name: 'Couples Spa', desc: 'Overwater spa treatment', price: 25000 },
            { id: 'mv_fishing', name: 'Night Fishing', desc: 'Traditional line fishing + BBQ', price: 10000 },
            { id: 'mv_romantic', name: 'Romantic Dinner', desc: 'Private beach candlelit dinner', price: 15000 }
        ],
        cities: [
            { name: 'Maldives Resort', days: 5, attractions: ['Snorkeling + Dolphin Cruise', 'Sunset Cruise + Sandbank'] }
        ]
    },
    'Dubai': {
        flag: 'üá¶üá™',
        image: 'https://images.unsplash.com/photo-1512453979798-5ea266f8880c?w=800&q=80',
        images: [
            'https://images.unsplash.com/photo-1512453979798-5ea266f8880c?w=800&q=80',
            'https://images.unsplash.com/photo-1518684079-3c830dcef090?w=800&q=80'
        ],
        category: 'Luxury & Shopping',
        tags: ['shopping', 'family', 'adventure'],
        coordinates: [25.2048, 55.2708],
        visaGuideUrl: 'https://goflybd.com/dubai-visa/',
        visaType: 'Tourist Visa (95% success)',
        visaFee: 8000,
        hotelBudget: 11000,
        hotelStandard: 20000,
        hotelLuxury: 38000,
        transfers: {
            'DXB ‚Üí Dubai City': { price: 6500, time: '30-45 min' },
            'Dubai ‚Üí Abu Dhabi': { price: 14000, time: '1.5-2 hours' }
        },
        activities: {
            'Burj Khalifa At The Top': { price: 7500, duration: '2 hours', city: 'Dubai' },
            'Desert Safari + BBQ Dinner': { price: 10000, duration: '6 hours', city: 'Dubai' },
            'Dubai Mall + Fountain Show': { price: 0, duration: '4 hours', city: 'Dubai' },
            'Sheikh Zayed Grand Mosque': { price: 0, duration: '2 hours', city: 'Abu Dhabi' },
            'Ferrari World': { price: 13000, duration: 'Full day', city: 'Abu Dhabi' }
        },
        addons: [
            { id: 'ae_yacht', name: 'Dubai Marina Yacht Cruise', desc: '2-hour luxury cruise', price: 8000 },
            { id: 'ae_skydive', name: 'Skydiving Palm Jumeirah', desc: 'Tandem jump experience', price: 55000 },
            { id: 'ae_balloon', name: 'Hot Air Balloon Ride', desc: 'Sunrise desert flight', price: 25000 },
            { id: 'ae_aquarium', name: 'Dubai Aquarium VIP', desc: 'Behind-the-scenes tour', price: 6000 }
        ],
        cities: [
            { name: 'Dubai', days: 4, attractions: ['Burj Khalifa At The Top', 'Desert Safari + BBQ Dinner', 'Dubai Mall + Fountain Show'] },
            { name: 'Abu Dhabi', days: 2, attractions: ['Sheikh Zayed Grand Mosque', 'Ferrari World'] }
        ]
    },
    'Vietnam': {
        flag: 'üáªüá≥',
        image: 'https://images.unsplash.com/photo-1583417319070-4a69db38a482?w=800&q=80',
        images: [
            'https://images.unsplash.com/photo-1583417319070-4a69db38a482?w=800&q=80'
        ],
        category: 'Culture & Food',
        tags: ['culture', 'adventure'],
        coordinates: [21.0285, 105.8542],
        visaGuideUrl: 'https://goflybd.com/vietnam-visa/',
        visaType: 'eVisa Online',
        visaFee: 7000,
        hotelBudget: 4000,
        hotelStandard: 8500,
        hotelLuxury: 17000,
        transfers: {
            'HAN ‚Üí Hanoi City': { price: 2200, time: '45-60 min' },
            'Hanoi ‚Üí Ha Long Bay': { price: 10000, time: '2.5-3.5 hours' }
        },
        activities: {
            'Hanoi Old Quarter Tour': { price: 4000, duration: '4 hours', city: 'Hanoi' },
            'Ha Long Bay Overnight Cruise': { price: 28000, duration: '2 days', city: 'Ha Long Bay' },
            'Cu Chi Tunnels': { price: 5000, duration: '4 hours', city: 'Ho Chi Minh City' }
        },
        addons: [
            { id: 'vn_street', name: 'Street Food Tour', desc: '3-hour walking food tour', price: 2500 },
            { id: 'vn_cyclo', name: 'Cyclo City Tour', desc: '2-hour traditional ride', price: 1800 },
            { id: 'vn_cooking', name: 'Vietnamese Cooking Class', desc: 'Market visit + cooking', price: 3500 }
        ],
        cities: [
            { name: 'Hanoi', days: 2, attractions: ['Hanoi Old Quarter Tour'] },
            { name: 'Ha Long Bay', days: 2, attractions: ['Ha Long Bay Overnight Cruise'] },
            { name: 'Ho Chi Minh City', days: 2, attractions: ['Cu Chi Tunnels'] }
        ]
    },
    'Sri Lanka': {
        flag: 'üá±üá∞',
        image: 'https://images.unsplash.com/photo-1594474420394-1e50fdcc0ec0?w=800&q=80',
        images: [
            'https://images.unsplash.com/photo-1594474420394-1e50fdcc0ec0?w=800&q=80'
        ],
        category: 'Heritage & Beach',
        tags: ['beach', 'culture', 'adventure'],
        coordinates: [6.9271, 79.8612],
        visaGuideUrl: 'https://goflybd.com/sri-lanka-visa/',
        visaType: 'eTA Online',
        visaFee: 5500,
        hotelBudget: 5000,
        hotelStandard: 10000,
        hotelLuxury: 20000,
        transfers: {
            'CMB ‚Üí Colombo City': { price: 4000, time: '45-60 min' },
            'Colombo ‚Üí Kandy': { price: 9000, time: '3-4 hours' },
            'Colombo ‚Üí Sigiriya': { price: 11000, time: '3.5-4.5 hours' }
        },
        activities: {
            'Sigiriya Rock Fortress': { price: 5500, duration: '3 hours', city: 'Sigiriya' },
            'Temple of the Tooth': { price: 7000, duration: '4 hours', city: 'Kandy' },
            'Bentota River Safari': { price: 4500, duration: '2 hours', city: 'Bentota' }
        },
        addons: [
            { id: 'lk_train', name: 'Scenic Train Ride', desc: 'Kandy to Ella famous route', price: 3000 },
            { id: 'lk_whale', name: 'Whale Watching', desc: 'Mirissa blue whale tour', price: 8000 },
            { id: 'lk_safari', name: 'Yala Safari', desc: 'Leopard spotting jeep safari', price: 12000 }
        ],
        cities: [
            { name: 'Colombo', days: 1, attractions: [] },
            { name: 'Kandy', days: 2, attractions: ['Temple of the Tooth'] },
            { name: 'Sigiriya', days: 1, attractions: ['Sigiriya Rock Fortress'] },
            { name: 'Bentota', days: 2, attractions: ['Bentota River Safari'] }
        ]
    },
    'Philippines': {
        flag: 'üáµüá≠',
        image: 'https://images.unsplash.com/photo-1621414050345-53db43f7e7ab?w=800&q=80',
        images: [
            'https://images.unsplash.com/photo-1621414050345-53db43f7e7ab?w=800&q=80'
        ],
        category: 'Island Hopping',
        tags: ['beach', 'adventure'],
        coordinates: [14.5995, 120.9842],
        visaGuideUrl: 'https://goflybd.com/philippines-visa/',
        visaType: 'Tourist Visa',
        visaFee: 7500,
        hotelBudget: 4500,
        hotelStandard: 9500,
        hotelLuxury: 18000,
        transfers: {
            'MNL ‚Üí Manila City': { price: 2800, time: '45-60 min' },
            'Manila ‚Üí Boracay': { price: 7000, time: '3-4 hours' }
        },
        activities: {
            'Intramuros Walking Tour': { price: 3500, duration: '3 hours', city: 'Manila' },
            'Boracay Island Hopping': { price: 5000, duration: 'Full day', city: 'Boracay' },
            'Underground River Tour': { price: 6500, duration: 'Full day', city: 'Palawan' }
        },
        addons: [
            { id: 'ph_helmet', name: 'Helmet Diving', desc: 'Underwater walking experience', price: 4000 },
            { id: 'ph_atv', name: 'ATV Adventure', desc: 'Beach and cliff ride', price: 3500 },
            { id: 'ph_sunset', name: 'Sunset Paraw Sailing', desc: 'Traditional boat cruise', price: 2500 }
        ],
        cities: [
            { name: 'Manila', days: 1, attractions: ['Intramuros Walking Tour'] },
            { name: 'Boracay', days: 4, attractions: ['Boracay Island Hopping'] },
            { name: 'Palawan', days: 3, attractions: ['Underground River Tour'] }
        ]
    }
};

// ==================== GLOBAL VARIABLES ====================
let currentStep = 1;
let selectedDestinations = [];
let selectedBudget = 'standard';
let selectedInterest = null;
let selectedAddons = [];
let tripData = {};
let map = null;
let markers = [];

// ==================== CURRENCY RATES (BDT) ====================
const currencyRates = {
    USD: 120,
    SGD: 89,
    MYR: 28,
    THB: 3.5,
    AED: 33,
    INR: 1.44,
    NPR: 0.90,
    LKR: 0.37,
    VND: 0.0049,
    PHP: 2.1,
    IDR: 0.0076
};

// ==================== INITIALIZATION ====================
window.onload = function() {
    renderDestinations();
    setMinDate();
    loadProgress();
    startCountdown();
    initMap();
};

// ==================== COUNTDOWN TIMER ====================
function startCountdown() {
    const countdownEl = document.getElementById('countdown');
    let hours = 23, mins = 59, secs = 59;
    
    setInterval(() => {
        secs--;
        if (secs < 0) { secs = 59; mins--; }
        if (mins < 0) { mins = 59; hours--; }
        if (hours < 0) { hours = 23; }
        
        countdownEl.textContent = 
            `${hours.toString().padStart(2, '0')}:${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
    }, 1000);
}

// ==================== MAP INITIALIZATION ====================
function initMap() {
    map = L.map('tripMap').setView([15, 100], 3);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '¬© OpenStreetMap'
    }).addTo(map);
}

function updateMap() {
    // Clear existing markers and lines
    markers.forEach(m => map.removeLayer(m));
    markers = [];
    
    if (selectedDestinations.length === 0) {
        document.getElementById('mapContainer').classList.remove('show');
        return;
    }
    
    document.getElementById('mapContainer').classList.add('show');
    
    const coords = [];
    selectedDestinations.forEach((destName, index) => {
        const dest = destinations[destName];
        const marker = L.marker(dest.coordinates)
            .addTo(map)
            .bindPopup(`<b>${index + 1}. ${dest.flag} ${destName}</b>`);
        markers.push(marker);
        coords.push(dest.coordinates);
    });
    
    // Draw route line
    if (coords.length > 1) {
        const polyline = L.polyline(coords, {color: '#10b981', weight: 3, dashArray: '10, 10'}).addTo(map);
        markers.push(polyline);
        map.fitBounds(polyline.getBounds(), {padding: [50, 50]});
    } else if (coords.length === 1) {
        map.setView(coords[0], 5);
    }
    
    setTimeout(() => map.invalidateSize(), 100);
}

// ==================== INTEREST SELECTION ====================
function selectInterest(interest, element) {
    document.querySelectorAll('.interest-chip').forEach(chip => chip.classList.remove('selected'));
    element.classList.add('selected');
    selectedInterest = interest;
    
    // Highlight recommended destinations
    document.querySelectorAll('.destination-card').forEach(card => {
        card.classList.remove('recommended');
    });
    
    Object.keys(destinations).forEach(name => {
        const dest = destinations[name];
        if (dest.tags && dest.tags.includes(interest)) {
            const card = document.querySelector(`[data-name="${name}"]`);
            if (card) card.classList.add('recommended');
        }
    });
    
    // Update combo suggestions
    updateComboSuggestions(interest);
    
    trackEvent('Trip Planner', 'Select Interest', interest);
}

function updateComboSuggestions(interest) {
    const combos = {
        beach: [
            { dests: ['Thailand', 'Malaysia'], days: 7, label: 'üáπüá≠üá≤üáæ Thailand + Malaysia (7D)' },
            { dests: ['Indonesia'], days: 6, label: 'üáÆüá© Bali Paradise (6D)' },
            { dests: ['Maldives'], days: 4, label: 'üá≤üáª Maldives Escape (4D)', trending: true }
        ],
        adventure: [
            { dests: ['Nepal'], days: 7, label: 'üá≥üáµ Nepal Adventure (7D)', trending: true },
            { dests: ['Indonesia'], days: 6, label: 'üáÆüá© Bali Active (6D)' },
            { dests: ['Sri Lanka'], days: 7, label: 'üá±üá∞ Sri Lanka Explorer (7D)' }
        ],
        culture: [
            { dests: ['Vietnam', 'Thailand'], days: 10, label: 'üáªüá≥üáπüá≠ Vietnam + Thailand (10D)' },
            { dests: ['Thailand'], days: 5, label: 'üáπüá≠ Thailand Heritage (5D)' },
            { dests: ['Sri Lanka'], days: 6, label: 'üá±üá∞ Sri Lanka Culture (6D)' }
        ],
        shopping: [
            { dests: ['Singapore', 'Malaysia'], days: 7, label: 'üá∏üá¨üá≤üáæ Singapore + Malaysia (7D)', trending: true },
            { dests: ['Dubai'], days: 5, label: 'üá¶üá™ Dubai Shopping (5D)' },
            { dests: ['Thailand', 'Malaysia', 'Singapore'], days: 10, label: 'üáπüá≠üá≤üáæüá∏üá¨ SEA Triple (10D)' }
        ],
        romantic: [
            { dests: ['Maldives'], days: 5, label: 'üá≤üáª Maldives Honeymoon (5D)', trending: true },
            { dests: ['Indonesia', 'Singapore'], days: 8, label: 'üáÆüá©üá∏üá¨ Bali + Singapore (8D)' },
            { dests: ['Thailand'], days: 6, label: 'üáπüá≠ Thailand Romance (6D)' }
        ],
        family: [
            { dests: ['Singapore', 'Malaysia'], days: 7, label: 'üá∏üá¨üá≤üáæ Singapore + Malaysia (7D)', trending: true },
            { dests: ['Thailand'], days: 6, label: 'üáπüá≠ Thailand Family Fun (6D)' },
            { dests: ['Dubai'], days: 5, label: 'üá¶üá™ Dubai Family (5D)' }
        ]
    };
    
    const selectedCombos = combos[interest] || combos.beach;
    const container = document.getElementById('comboChips');
    
    container.innerHTML = selectedCombos.map(combo => `
        <div class="combo-chip ${combo.trending ? 'trending' : ''}" onclick="selectCombo(${JSON.stringify(combo.dests)}, ${combo.days})">
            ${combo.label}
        </div>
    `).join('');
}

function selectCombo(dests, days) {
    selectedDestinations = [];
    document.querySelectorAll('.destination-card').forEach(card => card.classList.remove('selected'));
    
    dests.forEach(dest => {
        selectedDestinations.push(dest);
        const card = document.querySelector(`[data-name="${dest}"]`);
        if (card) card.classList.add('selected');
    });
    
    updateSelectedDisplay();
    document.getElementById('duration').value = days;
    updateDurationNote();
    updateMap();
    
    document.querySelector('.planner-card').scrollIntoView({ behavior: 'smooth', block: 'start' });
    trackEvent('Trip Planner', 'Select Combo', dests.join('+'), days);
}

// ==================== DESTINATION RENDERING ====================
function renderDestinations() {
    const grid = document.getElementById('destinationGrid');
    grid.innerHTML = Object.keys(destinations).map(name => {
        const dest = destinations[name];
        return `
            <div class="destination-card" 
                 style="background-image: url('${dest.image}')" 
                 onclick="toggleDestination('${name}')" 
                 data-name="${name}">
                <div class="destination-content">
                    <div>
                        <div class="destination-name">${dest.flag} ${name}</div>
                        <div class="destination-category">${dest.category}</div>
                        <div class="destination-tags">
                            ${dest.tags.slice(0, 3).map(tag => `<span class="destination-tag">${tag}</span>`).join('')}
                        </div>
                    </div>
                    <div style="font-size: 0.85rem; opacity: 0.9;">
                        ${dest.cities.length} ${dest.cities.length > 1 ? 'cities' : 'city'} ‚Ä¢ ${dest.visaType.split('(')[0].trim()}
                    </div>
                </div>
            </div>
        `;
    }).join('');
}

// ==================== DESTINATION SELECTION ====================
function toggleDestination(name) {
    const card = document.querySelector(`[data-name="${name}"]`);
    const index = selectedDestinations.indexOf(name);
    
    if (index > -1) {
        selectedDestinations.splice(index, 1);
        card.classList.remove('selected');
    } else {
        if (selectedDestinations.length >= 4) {
            alert('‡¶∏‡¶∞‡ßç‡¶¨‡ßã‡¶ö‡ßç‡¶ö ‡ß™‡¶ü‡¶ø destination ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶¨‡ßá‡¶®!');
            return;
        }
        selectedDestinations.push(name);
        card.classList.add('selected');
    }
    
    updateSelectedDisplay();
    checkSmartWarning();
    updateMap();
    saveProgress();
    trackEvent('Trip Planner', index > -1 ? 'Deselect' : 'Select', name);
}

function removeDestination(name) {
    const index = selectedDestinations.indexOf(name);
    if (index > -1) {
        selectedDestinations.splice(index, 1);
        const card = document.querySelector(`[data-name="${name}"]`);
        if (card) card.classList.remove('selected');
        updateSelectedDisplay();
        checkSmartWarning();
        updateMap();
        saveProgress();
    }
}

function updateSelectedDisplay() {
    const box = document.getElementById('selectedDestinationsBox');
    const list = document.getElementById('selectedList');
    const count = document.getElementById('selectedCount');
    const nextBtn = document.getElementById('step1Next');
    
    if (selectedDestinations.length > 0) {
        box.style.display = 'block';
        count.textContent = selectedDestinations.length;
        list.innerHTML = selectedDestinations.map(name => `
            <div class="selected-item">
                ${destinations[name].flag} ${name}
                <span class="remove-btn" onclick="removeDestination('${name}')">‚úï</span>
            </div>
        `).join('');
        nextBtn.disabled = false;
    } else {
        box.style.display = 'none';
        nextBtn.disabled = true;
    }
    updateDurationOptions();
}

// ==================== SMART WARNING SYSTEM ====================
function checkSmartWarning() {
    const warning = document.getElementById('smartWarning');
    const warningText = document.getElementById('warningText');
    const duration = parseInt(document.getElementById('duration').value) || 7;
    
    if (selectedDestinations.length >= 3 && duration <= 7) {
        warning.classList.add('show');
        warningText.innerHTML = `
            <strong>${selectedDestinations.length} countries in ${duration} days is very fast-paced!</strong><br><br>
            üìä <strong>Reality Check:</strong><br>
            ‚Ä¢ ${selectedDestinations.length - 1} travel days lost (flights + transfers)<br>
            ‚Ä¢ Only ${duration - (selectedDestinations.length - 1)} actual sightseeing days<br>
            ‚Ä¢ Average ${Math.floor((duration - (selectedDestinations.length - 1)) / selectedDestinations.length)} days per country<br><br>
            üí° <strong>Recommendation:</strong> ${selectedDestinations.length === 3 ? '10-12 days' : '12-14 days'} for a relaxed experience.
        `;
    } else if (selectedDestinations.length >= 2 && duration <= 5) {
        warning.classList.add('show');
        warningText.innerHTML = `
            <strong>2 countries in ${duration} days is tight!</strong><br>
            We recommend at least 7 days for 2-country trips.
        `;
    } else {
        warning.classList.remove('show');
    }
}

function extendDuration() {
    const recommendedDays = selectedDestinations.length === 2 ? 7 : selectedDestinations.length === 3 ? 10 : 14;
    document.getElementById('duration').value = recommendedDays;
    updateDurationNote();
    document.getElementById('smartWarning').classList.remove('show');
    trackEvent('Trip Planner', 'Accept Suggestion', 'Extend to ' + recommendedDays);
}

function keepCurrent() {
    document.getElementById('smartWarning').classList.remove('show');
    trackEvent('Trip Planner', 'Reject Suggestion', 'Keep Current');
}

// ==================== DURATION LOGIC ====================
function updateDurationOptions() {
    const numCountries = selectedDestinations.length;
    const d3 = document.getElementById('duration3');
    const d4 = document.getElementById('duration4');
    
    if (numCountries >= 2) {
        d3.disabled = true;
        d3.textContent = '3 Days (Too short for multi-country)';
        d4.disabled = true;
        d4.textContent = '4 Days (Too short for multi-country)';
    } else {
        d3.disabled = false;
        d3.textContent = '3 Days / 2 Nights';
        d4.disabled = false;
        d4.textContent = '4 Days / 3 Nights';
    }
}

function updateDurationNote() {
    const duration = parseInt(document.getElementById('duration').value);
    const note = document.getElementById('durationNote');
    const warning = document.getElementById('durationWarning');
    
    if (!duration || selectedDestinations.length === 0) {
        note.style.display = 'none';
        warning.style.display = 'none';
        return;
    }
    
    const distribution = calculateCityDistribution(duration);
    
    note.style.display = 'block';
    note.innerHTML = `<strong>üìç Your ${duration}-Day Journey:</strong><br><br>` +
        distribution.map((d, idx) => {
            const travelNote = idx > 0 ? ' <span style="color: var(--secondary);">(+1 travel)</span>' : '';
            return `${destinations[d.country].flag} <strong>${d.country}</strong>: ${d.cities.join(' ‚Üí ')}${travelNote}`;
        }).join('<br>');
    
    const minRecommended = selectedDestinations.length === 1 ? 3 : selectedDestinations.length === 2 ? 7 : selectedDestinations.length === 3 ? 10 : 14;
    document.getElementById('recommendedDays').textContent = minRecommended;
    warning.style.display = duration < minRecommended ? 'block' : 'none';
    
    checkSmartWarning();
    saveProgress();
}

function calculateCityDistribution(totalDays) {
    const distribution = [];
    const numCountries = selectedDestinations.length;
    const travelDaysBetweenCountries = numCountries > 1 ? numCountries - 1 : 0;
    const sightseeingDays = totalDays - travelDaysBetweenCountries;
    const baseDaysPerCountry = Math.floor(sightseeingDays / numCountries);
    let extraDays = sightseeingDays % numCountries;
    
    selectedDestinations.forEach((country, countryIdx) => {
        let countryDays = baseDaysPerCountry + (extraDays > 0 ? 1 : 0);
        if (extraDays > 0) extraDays--;
        
        let cityList = [];
        const allCities = destinations[country].cities;
        let citiesToInclude = [];
        let accumulatedDays = 0;
        
        for (const city of allCities) {
            const minDaysNeeded = Math.ceil(city.days * 0.6);
            if (accumulatedDays + minDaysNeeded <= countryDays) {
                citiesToInclude.push(city);
                accumulatedDays += city.days;
            } else if (citiesToInclude.length === 0) {
                citiesToInclude.push(city);
                break;
            }
        }
        
        const totalWeight = citiesToInclude.reduce((sum, c) => sum + c.days, 0);
        let remainingDays = countryDays;
        
        citiesToInclude.forEach((city, idx) => {
            let cityDays;
            if (idx === citiesToInclude.length - 1) {
                cityDays = Math.max(1, remainingDays);
            } else {
                cityDays = Math.max(1, Math.round((city.days / totalWeight) * countryDays));
            }
            cityList.push(`${city.name} (${cityDays}d)`);
            remainingDays -= cityDays;
        });
        
        distribution.push({
            country,
            cities: cityList,
            totalDays: countryDays,
            hasTravelDay: countryIdx > 0
        });
    });
    
    return distribution;
}

// ==================== BUDGET & DATE FUNCTIONS ====================
function selectBudget(budget, element) {
    selectedBudget = budget;
    document.querySelectorAll('.budget-option').forEach(opt => opt.classList.remove('selected'));
    element.classList.add('selected');
    saveProgress();
}

function setMinDate() {
    const tomorrow = new Date();
    tomorrow.setDate(tomorrow.getDate() + 14);
    document.getElementById('travelDate').min = tomorrow.toISOString().split('T')[0];
}

function checkPeakSeason2026() {
    const dateInput = document.getElementById('travelDate').value;
    if (!dateInput) return;
    
    const selectedDate = new Date(dateInput);
    const month = selectedDate.getMonth();
    const day = selectedDate.getDate();
    
    // Peak seasons 2026
    const isPeak = 
        (month === 1 && day >= 15 && day <= 25) || // Chinese NY
        (month === 3 && day >= 10 && day <= 20) || // Songkran
        (month === 11 && day >= 15) || // Christmas
        (month === 0 && day <= 10) || // New Year
        (month >= 5 && month <= 7); // Summer
    
    if (isPeak) {
        document.getElementById('peakSeason2026').style.display = 'block';
    } else {
        document.getElementById('peakSeason2026').style.display = 'none';
    }
    
    saveProgress();
}

// ==================== ADD-ONS SYSTEM ====================
function renderAddons() {
    const grid = document.getElementById('addonsGrid');
    const addons = [];
    
    selectedDestinations.forEach(destName => {
        const dest = destinations[destName];
        if (dest.addons) {
            dest.addons.forEach(addon => {
                addons.push({
                    ...addon,
                    country: destName,
                    flag: dest.flag
                });
            });
        }
    });
    
    if (addons.length === 0) {
        grid.innerHTML = '<p style="color: var(--gray-500); grid-column: 1/-1;">No add-ons available for selected destinations.</p>';
        return;
    }
    
    grid.innerHTML = addons.map(addon => `
        <div class="addon-item ${selectedAddons.includes(addon.id) ? 'selected' : ''}" onclick="toggleAddon('${addon.id}', ${addon.price})">
            <input type="checkbox" ${selectedAddons.includes(addon.id) ? 'checked' : ''}>
            <div class="addon-info">
                <div class="addon-name">${addon.flag} ${addon.name}</div>
                <div class="addon-desc">${addon.desc}</div>
            </div>
            <div class="addon-price">‡ß≥${addon.price.toLocaleString()}</div>
        </div>
    `).join('');
    
    updateAddonsTotal();
}

function toggleAddon(addonId, price) {
    const index = selectedAddons.indexOf(addonId);
    if (index > -1) {
        selectedAddons.splice(index, 1);
    } else {
        selectedAddons.push(addonId);
    }
    renderAddons();
}

function updateAddonsTotal() {
    let total = 0;
    selectedDestinations.forEach(destName => {
        const dest = destinations[destName];
        if (dest.addons) {
            dest.addons.forEach(addon => {
                if (selectedAddons.includes(addon.id)) {
                    total += addon.price;
                }
            });
        }
    });
    document.getElementById('addonsTotal').textContent = `‡ß≥${total.toLocaleString()}`;
}

function getAddonsTotal() {
    let total = 0;
    const adults = parseInt(document.getElementById('adults')?.value) || 2;
    
    selectedDestinations.forEach(destName => {
        const dest = destinations[destName];
        if (dest.addons) {
            dest.addons.forEach(addon => {
                if (selectedAddons.includes(addon.id)) {
                    total += addon.price * adults;
                }
            });
        }
    });
    return total;
}

// ==================== NAVIGATION ====================
function nextStep() {
    if (currentStep === 1 && selectedDestinations.length === 0) {
        alert('‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶Ö‡¶®‡ßç‡¶§‡¶§ ‡¶è‡¶ï‡¶ü‡¶ø destination ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®');
        return;
    }
    
    if (currentStep === 2) {
        if (!document.getElementById('duration').value) {
            alert('Trip duration ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®');
            return;
        }
        if (parseInt(document.getElementById('adults').value) < 1) {
            alert('‡¶ï‡¶Æ‡¶™‡¶ï‡ßç‡¶∑‡ßá ‡ßß ‡¶ú‡¶® Adult ‡¶•‡¶æ‡¶ï‡¶§‡ßá ‡¶π‡¶¨‡ßá');
            return;
        }
        if (!document.getElementById('travelDate').value) {
            alert('Travel date ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®');
            return;
        }
    }
    
    saveProgress();
    
    document.querySelector(`[data-section="${currentStep}"]`).classList.remove('active');
    document.querySelector(`[data-step="${currentStep}"]`).classList.remove('active');
    document.querySelector(`[data-step="${currentStep}"]`).classList.add('completed');
    
    currentStep++;
    
    document.querySelector(`[data-section="${currentStep}"]`).classList.add('active');
    document.querySelector(`[data-step="${currentStep}"]`).classList.add('active');
    
    if (currentStep >= 2) {
        document.getElementById('popularPackages').style.display = 'none';
        document.getElementById('testimonials').style.display = 'none';
        document.getElementById('interestSelector').style.display = 'none';
        document.getElementById('recommendedCombos').style.display = 'none';
    }
    
    if (currentStep === 3) {
        renderAddons();
    }
    
    window.scrollTo({ top: document.querySelector('.planner-card').offsetTop - 20, behavior: 'smooth' });
}

function prevStep() {
    document.querySelector(`[data-section="${currentStep}"]`).classList.remove('active');
    document.querySelector(`[data-step="${currentStep}"]`).classList.remove('active');
    
    currentStep--;
    
    if (currentStep === 1) {
        document.getElementById('popularPackages').style.display = 'block';
        document.getElementById('testimonials').style.display = 'block';
        document.getElementById('interestSelector').style.display = 'block';
        document.getElementById('recommendedCombos').style.display = 'block';
    }
    
    document.querySelector(`[data-section="${currentStep}"]`).classList.add('active');
    document.querySelector(`[data-step="${currentStep}"]`).classList.remove('completed');
    document.querySelector(`[data-step="${currentStep}"]`).classList.add('active');
    
    window.scrollTo({ top: document.querySelector('.planner-card').offsetTop - 20, behavior: 'smooth' });
}

// ==================== VALIDATION ====================
function validatePhone(phone) {
    return /^01[3-9]\d{8}$/.test(phone);
}

function validateEmail(email) {
    if (!email || email.trim() === '') return true;
    return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
}

function showError(inputId, errorId) {
    document.getElementById(inputId)?.classList.add('error');
    document.getElementById(errorId)?.classList.add('show');
}

function clearError(inputId, errorId) {
    document.getElementById(inputId)?.classList.remove('error');
    document.getElementById(errorId)?.classList.remove('show');
}

// ==================== SAVE/LOAD PROGRESS ====================
function saveProgress() {
    const saveData = {
        currentStep,
        selectedDestinations,
        selectedBudget,
        selectedInterest,
        selectedAddons,
        formData: {
            duration: document.getElementById('duration')?.value || '',
            adults: document.getElementById('adults')?.value || '2',
            children: document.getElementById('children')?.value || '0',
            travelDate: document.getElementById('travelDate')?.value || ''
        },
        timestamp: new Date().toISOString()
    };
    localStorage.setItem('gofly_trip_planner_v2', JSON.stringify(saveData));
    showSaveIndicator();
}

function loadProgress() {
    const saved = localStorage.getItem('gofly_trip_planner_v2');
    if (saved) {
        try {
            const data = JSON.parse(saved);
            const hoursDiff = (new Date() - new Date(data.timestamp)) / (1000 * 60 * 60);
            
            if (hoursDiff < 48 && data.selectedDestinations?.length > 0) {
                if (confirm('üìù ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶∏‡ßá‡¶∂‡¶® ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶ó‡ßá‡¶õ‡ßá‡•§ Resume ‡¶ï‡¶∞‡¶§‡ßá ‡¶ö‡¶æ‡¶®?')) {
                    selectedDestinations = data.selectedDestinations || [];
                    selectedBudget = data.selectedBudget || 'standard';
                    selectedInterest = data.selectedInterest;
                    selectedAddons = data.selectedAddons || [];
                    
                    selectedDestinations.forEach(dest => {
                        const card = document.querySelector(`[data-name="${dest}"]`);
                        if (card) card.classList.add('selected');
                    });
                    
                    if (data.formData) {
                        setTimeout(() => {
                            if (data.formData.duration) document.getElementById('duration').value = data.formData.duration;
                            if (data.formData.adults) document.getElementById('adults').value = data.formData.adults;
                            if (data.formData.children) document.getElementById('children').value = data.formData.children;
                            if (data.formData.travelDate) document.getElementById('travelDate').value = data.formData.travelDate;
                        }, 100);
                    }
                    
                    updateSelectedDisplay();
                    updateMap();
                }
            }
        } catch (e) {
            console.error('Load error:', e);
        }
    }
}

function showSaveIndicator() {
    const indicator = document.getElementById('saveIndicator');
    indicator.classList.add('show');
    setTimeout(() => indicator.classList.remove('show'), 2000);
}

// ==================== GENERATE ITINERARY ====================
function generateItinerary() {
    const userName = document.getElementById('userName').value.trim();
    const userPhone = document.getElementById('userPhone').value.trim();
    const userEmail = document.getElementById('userEmail').value.trim();
    
    clearError('userName', 'nameError');
    clearError('userPhone', 'phoneError');
    clearError('userEmail', 'emailError');
    
    let hasError = false;
    if (!userName) { showError('userName', 'nameError'); hasError = true; }
    if (!validatePhone(userPhone)) { showError('userPhone', 'phoneError'); hasError = true; }
    if (userEmail && !validateEmail(userEmail)) { showError('userEmail', 'emailError'); hasError = true; }
    
    if (hasError) return;
    
    // Show loading
    document.getElementById('itineraryResult').innerHTML = `
        <div class="loading-spinner">
            <div class="spinner">‚è≥</div>
            <p style="margin-top: 16px;">Creating your perfect 2026 itinerary...</p>
        </div>
    `;
    
    document.querySelectorAll('.form-section').forEach(s => s.classList.remove('active'));
    document.getElementById('stepIndicator').style.display = 'none';
    document.getElementById('itineraryResult').classList.add('active');
    
    window.scrollTo({ top: 0, behavior: 'smooth' });
    
    tripData = {
        destinations: selectedDestinations,
        duration: parseInt(document.getElementById('duration').value),
        adults: parseInt(document.getElementById('adults').value),
        children: parseInt(document.getElementById('children').value) || 0,
        travelDate: document.getElementById('travelDate').value,
        budget: selectedBudget,
        addons: selectedAddons,
        userName,
        userPhone,
        userEmail,
        specialNotes: document.getElementById('specialNotes').value
    };
    
    localStorage.removeItem('gofly_trip_planner_v2');
    
    setTimeout(displayItinerary, 2000);
}

// ==================== CALCULATE COSTS ====================
function calculateRealCosts() {
    const costs = {
        hotels: [],
        transfers: [],
        activities: [],
        visa: [],
        addons: [],
        totalHotels: 0,
        totalTransfers: 0,
        totalActivities: 0,
        totalVisa: 0,
        totalAddons: 0,
        discount: 0,
        grandTotal: 0
    };
    
    const totalDays = tripData.duration;
    const nights = totalDays - 1;
    const totalTravelers = tripData.adults + tripData.children;
    const roomsNeeded = Math.ceil(tripData.adults / 2);
    const distribution = calculateCityDistribution(totalDays);
    
    selectedDestinations.forEach((country, countryIdx) => {
        const dest = destinations[country];
        const countryInfo = distribution[countryIdx];
        const countryNights = countryInfo.totalDays;
        
        // Hotels
        let hotelRate = tripData.budget === 'economy' ? dest.hotelBudget : 
                        tripData.budget === 'premium' ? dest.hotelLuxury : dest.hotelStandard;
        const hotelType = tripData.budget === 'economy' ? '3‚òÖ' : tripData.budget === 'premium' ? '5‚òÖ' : '4‚òÖ';
        
        const hotelCost = hotelRate * countryNights * roomsNeeded;
        costs.hotels.push({ country, nights: countryNights, type: hotelType, ratePerNight: hotelRate, rooms: roomsNeeded, total: hotelCost });
        costs.totalHotels += hotelCost;
        
        // Visa
        if (dest.visaFee > 0) {
            const visaCost = dest.visaFee * tripData.adults;
            costs.visa.push({ country, feePerPerson: dest.visaFee, travelers: tripData.adults, total: visaCost });
            costs.totalVisa += visaCost;
        }
        
        // Transfers
        const transferKeys = Object.keys(dest.transfers);
        if (transferKeys.length > 0) {
            const mainTransfer = dest.transfers[transferKeys[0]];
            const transferCost = mainTransfer.perPerson ? mainTransfer.price * totalTravelers : mainTransfer.price;
            costs.transfers.push({ route: transferKeys[0], price: transferCost, time: mainTransfer.time, country });
            costs.totalTransfers += transferCost;
        }
        
        // Activities
        const activityKeys = Object.keys(dest.activities);
        const numActivities = Math.min(activityKeys.length, 3);
        for (let i = 0; i < numActivities; i++) {
            const actName = activityKeys[i];
            const activity = dest.activities[actName];
            const actCost = activity.perPerson ? activity.price * totalTravelers : activity.price;
            if (actCost > 0) {
                costs.activities.push({ name: actName, price: actCost, duration: activity.duration, country });
                costs.totalActivities += actCost;
            }
        }
        
        // Add-ons
        if (dest.addons) {
            dest.addons.forEach(addon => {
                if (selectedAddons.includes(addon.id)) {
                    const addonCost = addon.price * tripData.adults;
                    costs.addons.push({ name: addon.name, price: addonCost, country });
                    costs.totalAddons += addonCost;
                }
            });
        }
    });
    
    // Inter-country transfers
    if (selectedDestinations.length > 1) {
        for (let i = 0; i < selectedDestinations.length - 1; i++) {
            costs.transfers.push({
                route: `${selectedDestinations[i]} ‚Üí ${selectedDestinations[i + 1]}`,
                price: 8500,
                time: 'Flight day',
                country: 'Inter-country'
            });
            costs.totalTransfers += 8500;
        }
    }
    
    // Meals
    const mealRate = tripData.budget === 'economy' ? 1800 : tripData.budget === 'standard' ? 3000 : 5000;
    costs.mealsTotal = mealRate * totalDays * totalTravelers;
    costs.mealRate = mealRate;
    
    // 5% Early bird discount
    const subtotal = costs.totalHotels + costs.totalTransfers + costs.totalActivities + costs.totalVisa + costs.totalAddons + costs.mealsTotal;
    costs.discount = Math.round(subtotal * 0.05);
    costs.grandTotal = subtotal - costs.discount;
    
    return costs;
}

// ==================== DATE FORMATTING ====================
function formatDate(startDate, daysToAdd) {
    const date = new Date(startDate);
    date.setDate(date.getDate() + daysToAdd);
    return date.toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric', year: 'numeric' });
}

function formatDateShort(startDate, daysToAdd) {
    const date = new Date(startDate);
    date.setDate(date.getDate() + daysToAdd);
    return date.toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' });
}

// ==================== DISPLAY ITINERARY ====================
function displayItinerary() {
    const totalDays = tripData.duration;
    const nights = totalDays - 1;
    const totalTravelers = tripData.adults + tripData.children;
    const costs = calculateRealCosts();
    const perPersonCost = Math.round(costs.grandTotal / totalTravelers);
    
    const destinationFlags = selectedDestinations.map(d => destinations[d].flag).join(' ');
    const destinationNames = selectedDestinations.join(' + ');
    
    // WhatsApp message
    const whatsappMessage = encodeURIComponent(
        `Assalamu Alaikum goFLY!\n\n` +
        `üéØ Trip Request (via Trip Planner 2026):\n\n` +
        `üìç ${destinationNames}\n` +
        `üìÖ ${totalDays}D/${nights}N\n` +
        `üë• ${tripData.adults}A + ${tripData.children}C\n` +
        `üí∞ ${tripData.budget.toUpperCase()}\n` +
        `üìÜ ${formatDate(tripData.travelDate, 0)}\n` +
        `üíµ Land: ‡ß≥${costs.grandTotal.toLocaleString()} (5% discount applied)\n` +
        `${selectedAddons.length > 0 ? `‚ûï Add-ons: ${selectedAddons.length} items\n` : ''}` +
        `\n‚úàÔ∏è Please quote FLIGHTS!\n\n` +
        `Name: ${tripData.userName}\n` +
        `Phone: ${tripData.userPhone}`
    );
    
    // Why this itinerary points
    const whyPoints = generateWhyPoints();
    
    // Generate itinerary
    const itinerary = generateDynamicItinerary();
    
    const daysHtml = itinerary.map(day => {
        const dayClass = day.isTravelDay ? 'day-itinerary travel-day' : 'day-itinerary';
        const badgeClass = day.isTravelDay ? 'day-badge travel' : 'day-badge';
        
        return `
            <div class="${dayClass}">
                <h3>
                    <span class="${badgeClass}">Day ${day.day}</span>
                    ${formatDateShort(tripData.travelDate, day.day - 1)} - ${day.location}
                </h3>
                <ul class="activity-list">
                    ${day.activities.map(act => `
                        <li>
                            <div class="activity-time">${act.time}</div>
                            <div>
                                <div class="activity-name">${act.name}</div>
                                <div class="activity-desc">${act.desc}</div>
                                ${act.price > 0 ? `<div class="activity-price">‡ß≥${act.price.toLocaleString()}</div>` : ''}
                            </div>
                        </li>
                    `).join('')}
                </ul>
            </div>
        `;
    }).join('');
    
    // Visa links
    const visaLinksHtml = selectedDestinations.map(name => `
        <a href="${destinations[name].visaGuideUrl}" target="_blank" class="visa-link-card">
            <div class="flag">${destinations[name].flag}</div>
            <div class="info">
                <div class="country-name">${name} Visa</div>
                <div class="visa-type">${destinations[name].visaType}</div>
            </div>
            <div class="arrow">‚Üí</div>
        </a>
    `).join('');
    
    // Price breakdown
    const hotelBreakdownHtml = costs.hotels.map(h => `
        <div class="price-row">
            <span>${destinations[h.country].flag} ${h.country} (${h.nights}N √ó ${h.type} √ó ${h.rooms}rm)</span>
            <span>‡ß≥${h.total.toLocaleString()}</span>
        </div>
    `).join('');
    
    // FINAL HTML
    document.getElementById('itineraryResult').innerHTML = `
        <!-- Header -->
        <div class="result-header">
            <h2>üéâ Your ${selectedDestinations.length > 1 ? 'Multi-Destination ' : ''}2026 Adventure!</h2>
            <p style="font-size: 1.3rem; margin-bottom: 8px;">${destinationFlags} ${destinationNames}</p>
            <p style="font-size: 1rem; opacity: 0.9;">${totalDays}D / ${nights}N ‚Ä¢ ${totalTravelers} Travelers</p>
            <p style="font-size: 0.9rem; opacity: 0.8; margin-top: 8px;">üìÖ ${formatDate(tripData.travelDate, 0)} - ${formatDate(tripData.travelDate, totalDays - 1)}</p>
            <div class="discount-badge">üéÅ 5% Early Bird Discount Applied!</div>
        </div>
        
        <!-- Trip Summary -->
        <div class="trip-summary">
            <div class="summary-item">
                <div class="label">Countries</div>
                <div class="value">${selectedDestinations.length}</div>
            </div>
            <div class="summary-item">
                <div class="label">Duration</div>
                <div class="value">${totalDays}D/${nights}N</div>
            </div>
            <div class="summary-item">
                <div class="label">Travelers</div>
                <div class="value">${tripData.adults}A+${tripData.children}C</div>
            </div>
            <div class="summary-item">
                <div class="label">Add-ons</div>
                <div class="value">${selectedAddons.length}</div>
            </div>
            <div class="summary-item">
                <div class="label">Per Person</div>
                <div class="value" style="color: var(--primary);">‡ß≥${perPersonCost.toLocaleString()}</div>
            </div>
        </div>
        
        <!-- Why This Itinerary -->
        <div class="why-itinerary">
            <h4>üí° Why This Itinerary Works</h4>
            <div class="why-points">
                ${whyPoints.map(point => `
                    <div class="why-point">
                        <span class="icon">${point.icon}</span>
                        <span class="text">${point.text}</span>
                    </div>
                `).join('')}
            </div>
        </div>
        
        <!-- Flight Notice -->
        <div class="flight-notice">
            <h3>‚úàÔ∏è Flights Quoted Separately</h3>
            <p>IATA certified experts get exclusive rates. Save ‡ß≥5,000 - ‡ß≥20,000 on airfares!</p>
            <div class="flight-cta">
                <a href="https://wa.me/8801713289178?text=${whatsappMessage}" target="_blank" style="background: linear-gradient(135deg, #25d366 0%, #128c7e 100%); color: white;">
                    üí¨ Get Quote
                </a>
                <a href="tel:+8809639203090" style="background: var(--secondary); color: white;">
                    üìû 09639-203090
                </a>
            </div>
        </div>
        
        <!-- Download Buttons -->
        <div class="download-buttons">
            <button onclick="downloadPDF()" class="btn-download">üì• Download PDF</button>
            <button onclick="window.print()" class="btn-download" style="background: var(--primary);">üñ®Ô∏è Print</button>
            <button onclick="shareViaEmail()" class="btn-download" style="background: var(--secondary);">üì§ Share</button>
        </div>
        
        <!-- Day-by-Day -->
        <h3 style="font-size: 1.5rem; margin: 32px 0 20px;">üìÖ Day-by-Day Itinerary</h3>
        ${daysHtml}
        
        <!-- Price Breakdown -->
        <div class="price-breakdown">
            <h3 style="margin-bottom: 16px;">üí∞ Detailed Pricing (2026 Rates)</h3>
            
            <div class="price-category">üè® Accommodation</div>
            ${hotelBreakdownHtml}
            
            <div class="price-category">üöó Transfers</div>
            ${costs.transfers.map(t => `
                <div class="price-row"><span>${t.route}</span><span>‡ß≥${t.price.toLocaleString()}</span></div>
            `).join('')}
            
            <div class="price-category">üéØ Activities</div>
            ${costs.activities.map(a => `
                <div class="price-row"><span>${a.name}</span><span>‡ß≥${a.price.toLocaleString()}</span></div>
            `).join('')}
            
            ${costs.addons.length > 0 ? `
                <div class="price-category">‚ûï Selected Add-ons</div>
                ${costs.addons.map(a => `
                    <div class="price-row"><span>${a.name}</span><span>‡ß≥${a.price.toLocaleString()}</span></div>
                `).join('')}
            ` : ''}
            
            ${costs.visa.length > 0 ? `
                <div class="price-category">üõÇ Visa</div>
                ${costs.visa.map(v => `
                    <div class="price-row"><span>${destinations[v.country].flag} ${v.country} (${v.travelers}√ó‡ß≥${v.feePerPerson})</span><span>‡ß≥${v.total.toLocaleString()}</span></div>
                `).join('')}
            ` : ''}
            
            <div class="price-category">üçΩÔ∏è Meals</div>
            <div class="price-row"><span>${totalDays}D √ó ${totalTravelers}P √ó ‡ß≥${costs.mealRate}</span><span>‡ß≥${costs.mealsTotal.toLocaleString()}</span></div>
            
            <div class="price-row discount">
                <span>üéÅ Early Bird Discount (5%)</span>
                <span>-‡ß≥${costs.discount.toLocaleString()}</span>
            </div>
            
            <div class="price-row total">
                <span>TOTAL (Land Package)</span>
                <span>‡ß≥${costs.grandTotal.toLocaleString()}</span>
            </div>
        </div>
        
        <!-- Visa Links -->
        <div style="background: #fef3c7; border-radius: 16px; padding: 24px; margin-bottom: 24px;">
            <h3 style="color: #92400e; margin-bottom: 16px;">üìã Visa Guides</h3>
            <div class="visa-links-grid">${visaLinksHtml}</div>
        </div>
        
        <!-- CTA -->
        <div class="cta-section">
            <a href="https://wa.me/8801713289178?text=${whatsappMessage}" class="cta-button cta-whatsapp" target="_blank">
                üí¨ WhatsApp Quote
            </a>
            <a href="tel:+8809639203090" class="cta-button cta-call">
                üìû Call Now
            </a>
            <a href="mailto:support@goflybd.com?subject=Trip%20Quote%20${encodeURIComponent(destinationNames)}" class="cta-button cta-email">
                ‚úâÔ∏è Email
            </a>

                    </div>
        
        <!-- EMI Calculator -->
        <div class="emi-calculator">
            <h3>üí≥ EMI Calculator (0% Available)</h3>
            <div class="emi-inputs">
                <div class="emi-input-group">
                    <label>Amount (‡ß≥)</label>
                    <input type="number" id="emiAmount" value="${costs.grandTotal}">
                </div>
                <div class="emi-input-group">
                    <label>Down Payment</label>
                    <input type="number" id="emiDown" value="0" min="0">
                </div>
                <div class="emi-input-group">
                    <label>Months</label>
                    <select id="emiMonths">
                        <option value="3">3 Months</option>
                        <option value="6" selected>6 Months</option>
                        <option value="12">12 Months</option>
                        <option value="24">24 Months</option>
                    </select>
                </div>
                <div class="emi-input-group">
                    <label>Interest</label>
                    <select id="emiInterest">
                        <option value="0">0% (Select Banks)</option>
                        <option value="12" selected>12% Annual</option>
                        <option value="18">18% Annual</option>
                    </select>
                </div>
            </div>
            <button class="btn btn-primary" onclick="calculateEMI()" style="width: 100%;">Calculate EMI</button>
            <div class="emi-result" id="emiResult">
                <div class="emi-result-row"><span>Loan Amount:</span><span id="emiLoan">‡ß≥0</span></div>
                <div class="emi-result-row"><span>Interest:</span><span id="emiInt">‡ß≥0</span></div>
                <div class="emi-result-row"><span>Total:</span><span id="emiTotal">‡ß≥0</span></div>
                <div class="emi-result-row"><span><strong>Monthly EMI:</strong></span><span id="emiMonthly"><strong>‡ß≥0</strong></span></div>
            </div>
        </div>
        
        <!-- Rating Section -->
        <div class="rating-section">
            <h4>‚≠ê How was this trip planning experience?</h4>
            <div class="rating-stars">
                <span class="rating-star" onclick="setRating(1)">‚≠ê</span>
                <span class="rating-star" onclick="setRating(2)">‚≠ê</span>
                <span class="rating-star" onclick="setRating(3)">‚≠ê</span>
                <span class="rating-star" onclick="setRating(4)">‚≠ê</span>
                <span class="rating-star" onclick="setRating(5)">‚≠ê</span>
            </div>
            <div class="rating-feedback" id="ratingFeedback">
                <textarea id="feedbackText" placeholder="Tell us more about your experience (optional)..."></textarea>
                <button class="rating-submit" onclick="submitRating()">Submit Feedback</button>
            </div>
        </div>
        
        <!-- Plan Another -->
        <div style="text-align: center; margin-top: 32px; padding: 24px; background: var(--gray-50); border-radius: 12px;">
            <p style="color: var(--gray-600); margin-bottom: 16px;">Want to explore more options?</p>
            <button onclick="location.reload()" class="btn btn-secondary" style="padding: 14px 32px;">üîÑ Plan Another Trip</button>
        </div>
        
        <!-- Footer -->
        <div style="text-align: center; margin-top: 32px; padding: 32px; background: linear-gradient(135deg, var(--primary), var(--primary-dark)); color: white; border-radius: 16px;">
            <strong style="font-size: 1.5rem; display: block; margin-bottom: 12px;">goFLY Limited</strong>
            <p style="opacity: 0.9; line-height: 1.8;">
                IATA Certified ‚Ä¢ Since 2017 ‚Ä¢ 12,000+ Happy Travelers<br>
                üìç 1 Shukrabad Road, Dhanmondi, Dhaka 1207<br>
                üìû 09639-203090 | üí¨ 01713-289178<br>
                ‚úâÔ∏è support@goflybd.com | üåê goflybd.com
            </p>
        </div>
    `;
}

// ==================== GENERATE DYNAMIC ITINERARY ====================
function generateDynamicItinerary() {
    const itinerary = [];
    let currentDay = 1;
    const numCountries = selectedDestinations.length;
    const totalDays = tripData.duration;
    
    // Calculate days per country
    const travelDays = numCountries > 1 ? numCountries - 1 : 0;
    const sightseeingDays = totalDays - travelDays;
    const daysPerCountry = Math.floor(sightseeingDays / numCountries);
    let extraDays = sightseeingDays % numCountries;
    
    selectedDestinations.forEach((destKey, index) => {
        const dest = destinations[destKey];
        const isFirst = index === 0;
        const isLast = index === selectedDestinations.length - 1;
        
        let countryDays = daysPerCountry + (extraDays > 0 ? 1 : 0);
        if (extraDays > 0) extraDays--;
        
        const cities = dest.cities;
        const activities = Object.keys(dest.activities);
        let activityIdx = 0;
        
        // ARRIVAL / TRAVEL DAY
        if (isFirst) {
            const transfer = Object.values(dest.transfers)[0];
            itinerary.push({
                day: currentDay,
                location: `${cities[0]?.name || destKey} (Arrival)`,
                isTravelDay: true,
                country: destKey,
                activities: [
                    { time: '09:00 AM', name: '‚úàÔ∏è Arrival', desc: 'International flight arrival, immigration', price: 0 },
                    { time: '11:00 AM', name: 'üöó Airport Transfer', desc: transfer ? `${transfer.time} to hotel` : 'Transfer to hotel', price: transfer ? transfer.price : 5000 },
                    { time: '01:00 PM', name: 'üè® Check-in', desc: 'Hotel check-in, freshen up', price: 0 },
                    { time: '03:00 PM', name: 'üçΩÔ∏è Lunch', desc: 'Local cuisine experience', price: 0 },
                    { time: '05:00 PM', name: 'üö∂ Light Walk', desc: 'Explore nearby area', price: 0 },
                    { time: '08:00 PM', name: 'üåô Dinner', desc: 'Rest and early dinner', price: 0 }
                ]
            });
            currentDay++;
            countryDays--;
        } else {
            // Inter-country travel
            const prevDest = selectedDestinations[index - 1];
            itinerary.push({
                day: currentDay,
                location: `${prevDest} ‚Üí ${destKey}`,
                isTravelDay: true,
                country: 'Travel',
                activities: [
                    { time: '07:00 AM', name: 'üè® Checkout', desc: 'Breakfast and checkout', price: 0 },
                    { time: '09:00 AM', name: 'üöó Airport', desc: 'Transfer to airport', price: 6000 },
                    { time: '12:00 PM', name: '‚úàÔ∏è Flight', desc: `Fly to ${destKey}`, price: 0 },
                    { time: '03:00 PM', name: 'üõ¨ Arrival', desc: 'Immigration & baggage', price: 0 },
                    { time: '05:00 PM', name: 'üè® Check-in', desc: 'Transfer to hotel', price: 5000 },
                    { time: '08:00 PM', name: 'üåô Dinner', desc: 'Local dinner', price: 0 }
                ]
            });
            currentDay++;
            countryDays--;
        }
        
        // SIGHTSEEING DAYS
        const fullDays = countryDays - (isLast ? 1 : 0);
        for (let d = 0; d < fullDays; d++) {
            const cityIdx = d % cities.length;
            const cityName = cities[cityIdx]?.name || destKey;
            
            const morningAct = activities[activityIdx % activities.length];
            const afternoonAct = activities[(activityIdx + 1) % activities.length];
            activityIdx += 2;
            
            const morningData = dest.activities[morningAct];
            const afternoonData = dest.activities[afternoonAct];
            
            itinerary.push({
                day: currentDay,
                location: `${destKey} - ${cityName}`,
                isTravelDay: false,
                country: destKey,
                activities: [
                    { time: '08:00 AM', name: 'üç≥ Breakfast', desc: 'Hotel buffet breakfast', price: 0 },
                    { time: '09:30 AM', name: `üéØ ${morningAct}`, desc: morningData ? morningData.duration : 'Morning tour', price: morningData ? morningData.price : 0 },
                    { time: '01:00 PM', name: 'üç± Lunch', desc: 'Local cuisine', price: 0 },
                    { time: '03:00 PM', name: `üé® ${afternoonAct}`, desc: afternoonData ? afternoonData.duration : 'Afternoon activity', price: afternoonData ? afternoonData.price : 0 },
                    { time: '06:30 PM', name: 'üåÖ Free Time', desc: 'Sunset views or shopping', price: 0 },
                    { time: '08:00 PM', name: 'üçΩÔ∏è Dinner', desc: 'Restaurant or street food', price: 0 }
                ]
            });
            currentDay++;
        }
        
        // DEPARTURE DAY
        if (isLast) {
            itinerary.push({
                day: currentDay,
                location: 'Departure Day',
                isTravelDay: true,
                country: destKey,
                activities: [
                    { time: '08:00 AM', name: 'üç≥ Breakfast', desc: 'Final hotel breakfast', price: 0 },
                    { time: '10:00 AM', name: 'üè® Checkout', desc: 'Pack and checkout', price: 0 },
                    { time: '10:30 AM', name: 'üõçÔ∏è Shopping', desc: 'Last-minute souvenirs', price: 0 },
                    { time: '01:00 PM', name: 'üöó Airport', desc: 'Transfer to airport', price: 5000 },
                    { time: '04:00 PM', name: '‚úàÔ∏è Departure', desc: 'Fly home! üëã', price: 0 }
                ]
            });
        }
    });
    
    return itinerary;
}

// ==================== WHY THIS ITINERARY POINTS ====================
function generateWhyPoints() {
    const points = [];
    const numCountries = selectedDestinations.length;
    const duration = tripData.duration;
    const travelDays = numCountries > 1 ? numCountries - 1 : 0;
    const sightseeingDays = duration - travelDays;
    
    // Balance check
    if (sightseeingDays >= numCountries * 2) {
        points.push({ icon: '‚öñÔ∏è', text: 'Well-balanced pace - enough time in each destination' });
    }
    
    // Interest-based
    if (selectedInterest) {
        const interestText = {
            beach: 'Includes beautiful beaches and water activities',
            adventure: 'Packed with thrilling adventures and outdoor activities',
            culture: 'Rich cultural experiences and heritage sites',
            shopping: 'Premium shopping destinations included',
            romantic: 'Perfect romantic spots for couples',
            family: 'Family-friendly attractions and activities'
        };
        if (interestText[selectedInterest]) {
            points.push({ icon: 'üéØ', text: interestText[selectedInterest] });
        }
    }
    
    // Geographic efficiency
    if (numCountries >= 2) {
        const allSEA = selectedDestinations.every(d => ['Thailand', 'Malaysia', 'Singapore', 'Vietnam', 'Indonesia', 'Philippines'].includes(d));
        if (allSEA) {
            points.push({ icon: 'üó∫Ô∏è', text: 'Geographically efficient route - minimal flight times' });
        }
    }
    
    // Season check
    const travelMonth = new Date(tripData.travelDate).getMonth();
    const goodMonths = [2, 3, 9, 10]; // Mar, Apr, Oct, Nov
    if (goodMonths.includes(travelMonth)) {
        points.push({ icon: '‚òÄÔ∏è', text: 'Great weather season - less crowds, better prices' });
    }
    
    // Visa convenience
    const easyVisa = selectedDestinations.filter(d => 
        destinations[d].visaType.includes('Arrival') || destinations[d].visaType.includes('eVisa')
    );
    if (easyVisa.length === selectedDestinations.length) {
        points.push({ icon: '‚úÖ', text: 'Easy visa process - On Arrival or eVisa available' });
    }
    
    // Budget optimization
    if (tripData.budget === 'standard') {
        points.push({ icon: 'üí∞', text: 'Best value for money - 4‚òÖ hotels at competitive rates' });
    }
    
    // Add-ons
    if (selectedAddons.length > 0) {
        points.push({ icon: '‚ûï', text: `${selectedAddons.length} personalized add-ons included` });
    }
    
    // Always add
    points.push({ icon: 'üõ°Ô∏è', text: '24/7 goFLY support throughout your journey' });
    
    return points.slice(0, 6); // Max 6 points
}

// ==================== EMI CALCULATOR ====================
function calculateEMI() {
    const amount = parseInt(document.getElementById('emiAmount').value) || 0;
    const down = parseInt(document.getElementById('emiDown').value) || 0;
    const months = parseInt(document.getElementById('emiMonths').value);
    const rate = parseFloat(document.getElementById('emiInterest').value);
    
    const loan = amount - down;
    if (loan <= 0) {
        alert('Loan amount must be positive');
        return;
    }
    
    let monthly, interest;
    if (rate === 0) {
        monthly = loan / months;
        interest = 0;
    } else {
        const r = rate / 12 / 100;
        monthly = loan * r * Math.pow(1 + r, months) / (Math.pow(1 + r, months) - 1);
        interest = (monthly * months) - loan;
    }
    
    document.getElementById('emiLoan').textContent = '‡ß≥' + loan.toLocaleString();
    document.getElementById('emiInt').textContent = '‡ß≥' + Math.round(interest).toLocaleString();
    document.getElementById('emiTotal').textContent = '‡ß≥' + Math.round(loan + interest).toLocaleString();
    document.getElementById('emiMonthly').innerHTML = '<strong>‡ß≥' + Math.round(monthly).toLocaleString() + '/month</strong>';
    document.getElementById('emiResult').classList.add('show');
}

// ==================== RATING SYSTEM ====================
let userRating = 0;

function setRating(rating) {
    userRating = rating;
    document.querySelectorAll('.rating-star').forEach((star, idx) => {
        star.classList.toggle('active', idx < rating);
    });
    document.getElementById('ratingFeedback').classList.add('show');
}

function submitRating() {
    const feedback = document.getElementById('feedbackText').value;
    
    // Send to analytics
    trackEvent('Trip Planner', 'Rating Submitted', userRating + ' stars', userRating);
    
    if (feedback) {
        trackEvent('Trip Planner', 'Feedback Submitted', feedback.substring(0, 100));
    }
    
    // Show thank you
    document.querySelector('.rating-section').innerHTML = `
        <div style="text-align: center; padding: 20px;">
            <div style="font-size: 3rem; margin-bottom: 12px;">üôè</div>
            <h4 style="color: #7e22ce; margin-bottom: 8px;">Thank You!</h4>
            <p style="color: var(--gray-600);">Your feedback helps us improve.</p>
        </div>
    `;
    
    // Save to localStorage for future reference
    const ratingData = {
        rating: userRating,
        feedback,
        destinations: selectedDestinations,
        date: new Date().toISOString()
    };
    
    let ratings = JSON.parse(localStorage.getItem('gofly_ratings') || '[]');
    ratings.push(ratingData);
    localStorage.setItem('gofly_ratings', JSON.stringify(ratings.slice(-10))); // Keep last 10
}

// ==================== PDF DOWNLOAD ====================
function downloadPDF() {
    const win = window.open('', '_blank');
    const costs = calculateRealCosts();
    const itinerary = generateDynamicItinerary();
    const destinationNames = selectedDestinations.join(' + ');
    
    win.document.write(`
        <!DOCTYPE html>
        <html>
        <head>
            <title>goFLY Trip - ${tripData.userName}</title>
            <style>
                * { margin: 0; padding: 0; box-sizing: border-box; }
                body { font-family: Arial, sans-serif; padding: 30px; color: #333; line-height: 1.6; }
                .header { background: linear-gradient(135deg, #10b981, #059669); color: white; padding: 25px; border-radius: 10px; text-align: center; margin-bottom: 25px; }
                .header h1 { font-size: 22px; margin-bottom: 8px; }
                .summary { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-bottom: 25px; }
                .summary-item { background: #f1f5f9; padding: 12px; border-radius: 8px; text-align: center; }
                .summary-item .label { font-size: 11px; color: #64748b; }
                .summary-item .value { font-size: 18px; font-weight: bold; }
                .day { background: #f8fafc; padding: 16px; border-radius: 8px; margin-bottom: 12px; border-left: 4px solid #10b981; page-break-inside: avoid; }
                .day.travel { border-left-color: #f97316; background: #fff7ed; }
                .day h3 { font-size: 14px; margin-bottom: 10px; }
                .activity { display: flex; padding: 6px 0; border-bottom: 1px solid #e2e8f0; font-size: 12px; }
                .activity:last-child { border-bottom: none; }
                .activity-time { font-weight: bold; color: #10b981; min-width: 70px; }
                .price-table { background: #f0fdf4; padding: 16px; border-radius: 8px; margin-top: 20px; }
                .price-row { display: flex; justify-content: space-between; padding: 6px 0; border-bottom: 1px solid #d1fae5; font-size: 12px; }
                .price-row.total { font-weight: bold; font-size: 14px; color: #10b981; border-top: 2px solid #10b981; margin-top: 8px; padding-top: 10px; }
                .footer { text-align: center; margin-top: 25px; padding: 15px; background: #f1f5f9; border-radius: 8px; font-size: 11px; color: #64748b; }
                @media print { body { padding: 15px; } }
            </style>
        </head>
        <body>
            <div class="header">
                <h1>‚úàÔ∏è ${destinationNames}</h1>
                <p>${tripData.duration} Days ‚Ä¢ ${tripData.adults + tripData.children} Travelers</p>
                <p style="margin-top: 5px; font-size: 12px;">Prepared for: ${tripData.userName} | ${new Date().toLocaleDateString()}</p>
            </div>
            
            <div class="summary">
                <div class="summary-item"><div class="label">Countries</div><div class="value">${selectedDestinations.length}</div></div>
                <div class="summary-item"><div class="label">Duration</div><div class="value">${tripData.duration}D</div></div>
                <div class="summary-item"><div class="label">Travel Date</div><div class="value" style="font-size: 12px;">${formatDateShort(tripData.travelDate, 0)}</div></div>
                <div class="summary-item"><div class="label">Land Package</div><div class="value" style="font-size: 14px;">‡ß≥${costs.grandTotal.toLocaleString()}</div></div>
            </div>
            
            <h2 style="font-size: 16px; margin-bottom: 15px;">üìÖ Itinerary</h2>
            ${itinerary.map(day => `
                <div class="day ${day.isTravelDay ? 'travel' : ''}">
                    <h3>Day ${day.day}: ${formatDateShort(tripData.travelDate, day.day - 1)} - ${day.location}</h3>
                    ${day.activities.map(a => `
                        <div class="activity">
                            <span class="activity-time">${a.time}</span>
                            <span>${a.name} - ${a.desc}${a.price > 0 ? ' (‡ß≥' + a.price.toLocaleString() + ')' : ''}</span>
                        </div>
                    `).join('')}
                </div>
            `).join('')}
            
            <div class="price-table">
                <h3 style="margin-bottom: 10px; font-size: 14px;">üí∞ Cost Summary</h3>
                <div class="price-row"><span>Hotels</span><span>‡ß≥${costs.totalHotels.toLocaleString()}</span></div>
                <div class="price-row"><span>Transfers</span><span>‡ß≥${costs.totalTransfers.toLocaleString()}</span></div>
                <div class="price-row"><span>Activities</span><span>‡ß≥${costs.totalActivities.toLocaleString()}</span></div>
                ${costs.totalAddons > 0 ? `<div class="price-row"><span>Add-ons</span><span>‡ß≥${costs.totalAddons.toLocaleString()}</span></div>` : ''}
                ${costs.totalVisa > 0 ? `<div class="price-row"><span>Visa</span><span>‡ß≥${costs.totalVisa.toLocaleString()}</span></div>` : ''}
                <div class="price-row"><span>Meals</span><span>‡ß≥${costs.mealsTotal.toLocaleString()}</span></div>
                <div class="price-row" style="color: #ef4444;"><span>Discount (5%)</span><span>-‡ß≥${costs.discount.toLocaleString()}</span></div>
                <div class="price-row total"><span>TOTAL</span><span>‡ß≥${costs.grandTotal.toLocaleString()}</span></div>
            </div>
            
            <div class="footer">
                <strong>goFLY Limited</strong> | IATA Certified | Since 2017<br>
                üìû 09639-203090 | üí¨ 01713-289178 | ‚úâÔ∏è support@goflybd.com | üåê goflybd.com<br>
                üìç 1 Shukrabad Road, Dhanmondi, Dhaka 1207
            </div>
        </body>
        </html>
    `);
    
    win.document.close();
    win.focus();
    setTimeout(() => win.print(), 500);
    
    trackEvent('Trip Planner', 'Download PDF', destinationNames);
}

// ==================== SHARE VIA EMAIL ====================
function shareViaEmail() {
    const costs = calculateRealCosts();
    const destinationNames = selectedDestinations.join(' + ');
    
    const subject = encodeURIComponent(`My ${destinationNames} Trip Plan - goFLY`);
    const body = encodeURIComponent(
        `Check out my trip plan!\n\n` +
        `üìç Destinations: ${destinationNames}\n` +
        `üìÖ Duration: ${tripData.duration} days\n` +
        `üë• Travelers: ${tripData.adults + tripData.children}\n` +
        `üìÜ Travel Date: ${formatDate(tripData.travelDate, 0)}\n` +
        `üí∞ Land Package: ‡ß≥${costs.grandTotal.toLocaleString()} (5% discount!)\n\n` +
        `Planned with goFLY Limited\n` +
        `üåê goflybd.com | üìû 09639-203090`
    );
    
    window.location.href = `mailto:?subject=${subject}&body=${body}`;
    trackEvent('Trip Planner', 'Share Email', destinationNames);
}

// ==================== ANALYTICS ====================
function trackEvent(category, action, label, value) {
    console.log('üìä', category, action, label, value);
    
    // Google Analytics
    if (typeof gtag !== 'undefined') {
        gtag('event', action, {
            event_category: category,
            event_label: label,
            value: value
        });
    }
    
    // Facebook Pixel
    if (typeof fbq !== 'undefined') {
        fbq('trackCustom', action, { category, label, value });
    }
}

// ==================== POPULAR PACKAGE SELECTION ====================
function selectPopularPackage(dests, days) {
    selectedDestinations = [];
    document.querySelectorAll('.destination-card').forEach(card => card.classList.remove('selected'));
    
    dests.forEach(dest => {
        selectedDestinations.push(dest);
        const card = document.querySelector(`[data-name="${dest}"]`);
        if (card) card.classList.add('selected');
    });
    
    updateSelectedDisplay();
    document.getElementById('duration').value = days;
    updateDurationNote();
    updateMap();
    
    document.querySelector('.planner-card').scrollIntoView({ behavior: 'smooth', block: 'start' });
    trackEvent('Trip Planner', 'Select Package', dests.join('+'), days);
}

// ==================== CURRENCY CONVERSION HELPER ====================
function convertCurrency(amount, fromCurrency) {
    if (fromCurrency === 'BDT') return amount;
    const rate = currencyRates[fromCurrency] || 1;
    return Math.round(amount * rate);
}

function formatMultiCurrency(bdtAmount) {
    return {
        BDT: bdtAmount,
        USD: Math.round(bdtAmount / currencyRates.USD),
        SGD: Math.round(bdtAmount / currencyRates.SGD),
        MYR: Math.round(bdtAmount / currencyRates.MYR)
    };
}

// ==================== UPDATE STEP INDICATOR ====================
function updateStepIndicator() {
    document.querySelectorAll('.step').forEach((step, idx) => {
        const stepNum = idx + 1;
        step.classList.remove('active', 'completed');
        if (stepNum < currentStep) {
            step.classList.add('completed');
        } else if (stepNum === currentStep) {
            step.classList.add('active');
        }
    });
}

function renderCurrentStep() {
    document.querySelectorAll('.form-section').forEach(s => s.classList.remove('active'));
    document.querySelector(`[data-section="${currentStep}"]`)?.classList.add('active');
    updateStepIndicator();
}

// ==================== CONSOLE WELCOME ====================
console.log(`
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë  üåç goFLY Trip Planner v2.0 (2026)       ‚ïë
‚ïë  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ    ‚ïë
‚ïë  üìû Hotline: 09639-203090                ‚ïë
‚ïë  üí¨ WhatsApp: 01713-289178               ‚ïë
‚ïë  üåê goflybd.com                          ‚ïë
‚ïë  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ    ‚ïë
‚ïë  IATA: 42337956 | ATAB: 4298             ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
`);
</script>
</body>
</html>
